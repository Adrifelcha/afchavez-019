a <- 0.6
R2 <- c(rep(0, 50))
R2[c(1, 10, 20, 30, 40)]<-100
for (k in 1:length(R2))
{
V1[1]<- 0
V1[(k+1)]= a*V1[k] + (1-a)*R2[k]
}
plot(V2, type='b',
col='aqua marine',xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
for (k in 1:length(R2))
{
V2[1]<- 0
V2[(k+1)]= a*V2[k] + (1-a)*R2[k]
}
plot(V2, type='b',
col='aqua marine',xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
V2 <- c()
a <- 0.6
R2 <- c(rep(0, 50))
R2[c(1, 10, 20, 30, 40)]<-100
for (k in 1:length(R2))
{
V2[1]<- 0
V2[(k+1)]= a*V2[k] + (1-a)*R2[k]
}
plot(V2, type='b',
col='aqua',xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
#Facultad de Psicolog?a, UNAM
#Karina Ruiz
#Ejemplo Integrador
par(mfrow=c(3,1))
#1 solo pulso
V1 <- c()
a <- 0.6
R1 <- c(100,rep(0, 49))
for (k in 1:length(R1))
{
V1[1]<- 0
V1[(k+1)]= a*V1[k] + (1-a)*R1[k]
}
plot(V1, type='b',
col='orange',xlab="Ensayo",ylab="Valor de V",pch=16,
main="Un solo pulso")
#Más pulsos
V2 <- c()
a <- 0.6
R2 <- c(rep(0, 50))
R2[c(1, 10, 20, 30, 40)]<-100
for (k in 1:length(R2))
{
V2[1]<- 0
V2[(k+1)]= a*V2[k] + (1-a)*R2[k]
}
plot(V2, type='b',
col='aqua',xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
plot(V2, type='b',
col="corn flower blue",xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
V3 <- c()
a <- 0.6
R3 <- c(rep(100, 50))
for (k in 1:length(R3))
{
V3[1]<- 0
V3[(k+1)]= a*V3[k] + (1-a)*R3[k]
}
plot(V3, type='b',
col="corn flower blue",xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
par(mfrow=c(2,2))
#1 solo pulso
V1 <- c()
a <- 0.6
R1 <- c(100,rep(0, 49))
for (k in 1:length(R1))
{
V1[1]<- 0
V1[(k+1)]= a*V1[k] + (1-a)*R1[k]
}
plot(V1, type='b',
col='orange',xlab="Ensayo",ylab="Valor de V",pch=16,
main="Un solo pulso")
#Más pulsos
V2 <- c()
a <- 0.6
R2 <- c(rep(0, 50))
R2[c(1, 10, 20, 30, 40)]<-100
for (k in 1:length(R2))
{
V2[1]<- 0
V2[(k+1)]= a*V2[k] + (1-a)*R2[k]
}
plot(V2, type='b',
col="corn flower blue",xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
#Continuo
V3 <- c()
a <- 0.6
R3 <- c(rep(100, 50))
for (k in 1:length(R3))
{
V3[1]<- 0
V3[(k+1)]= a*V3[k] + (1-a)*R3[k]
}
plot(V3, type='b',
col="corn flower blue",xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
#Facultad de Psicolog?a, UNAM
#Karina Ruiz
#Ejemplo Integrador
par(mfrow=c(2,2))
#1 solo pulso
V1 <- c()
a <- 0.6
R1 <- c(100,rep(0, 49))
for (k in 1:length(R1))
{
V1[1]<- 0
V1[(k+1)]= a*V1[k] + (1-a)*R1[k]
}
plot(V1, type='b',
col='orange',xlab="Ensayo",ylab="Valor de V",pch=16,
main="Un solo pulso")
#Más pulsos
V2 <- c()
a <- 0.6
R2 <- c(rep(0, 50))
R2[c(1, 10, 20, 30, 40)]<-100
for (k in 1:length(R2))
{
V2[1]<- 0
V2[(k+1)]= a*V2[k] + (1-a)*R2[k]
}
plot(V2, type='b',
col="corn flower blue",xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
#Continuo
V3 <- c()
a <- 0.6
R3 <- c(rep(100, 50))
for (k in 1:length(R3))
{
V3[1]<- 0
V3[(k+1)]= a*V3[k] + (1-a)*R3[k]
}
plot(V3, type='b',
col="corn flower blue",xlab="Ensayo",ylab="Valor de V",pch=16,
main="Pulsos continuos")
#Facultad de Psicolog?a, UNAM
#Karina Ruiz
#Ejemplo Integrador
par(mfrow=c(2,2))
#1 solo pulso
V1 <- c()
a <- 0.6
R1 <- c(100,rep(0, 49))
for (k in 1:length(R1))
{
V1[1]<- 0
V1[(k+1)]= a*V1[k] + (1-a)*R1[k]
}
plot(V1, type='b',
col='orange',xlab="Ensayo",ylab="Valor de V",pch=16,
main="Un solo pulso")
#Más pulsos
V2 <- c()
a <- 0.6
R2 <- c(rep(0, 50))
R2[c(1, 10, 20, 30, 40)]<-100
for (k in 1:length(R2))
{
V2[1]<- 0
V2[(k+1)]= a*V2[k] + (1-a)*R2[k]
}
plot(V2, type='b',
col="corn flower blue",xlab="Ensayo",ylab="Valor de V",pch=16,
main="Varios pulsos")
#Continuo
V3 <- c()
a <- 0.6
R3 <- c(rep(100, 50))
for (k in 1:length(R3))
{
V3[1]<- 0
V3[(k+1)]= a*V3[k] + (1-a)*R3[k]
}
plot(V3, type='b',
col="light coral",xlab="Ensayo",ylab="Valor de V",pch=16,
main="Pulsos continuos")
#############################################################
# Estimacion del modelo DINA para la aplicación de la prueba
# PLANEA ELCE 2015 con las especificaciones del modelo
# empleadas por el Dr. Guaner Rojas para la prueba PLANEA 06
#
#Se incluye también una versión más "rigida" del modelo
#############################################################
rm(list=ls())                       #
library("CDM")
setwd("C:/Users/Alejandro/Desktop/afchavez19/RIMEDIE/Mat09_2015/Post-Reunión25042018/DINA_Estimaciones")
Respuestas <- read.csv("PLANEA.09.2015_IDENT_ITEMS_ajustado.csv")
Respuestas$ESCUELA <- NULL
Respuestas$ID_ENT <- NULL
Respuestas$NOM_ENT <- NULL
Respuestas$ID_SERV <- NULL    #Se eliminan las columnas innecesarias
Respuestas$SERV <- NULL
Respuestas$MARGINC <- NULL
Respuestas$TAM_LOC_SEC <- NULL
Respuestas$SEXO <- NULL
Respuestas$EDAD_AC <- NULL
Respuestas$MES_NAC <- NULL
Respuestas$EDAD <- NULL
Respuestas$ï..ALUMNO <- NULL
Qmat <- read.csv("QMatriz_MAT09_ajustada.csv")
#Se utiliza la Matriz Q para identificar los reactivos que corresponden a cada Eje
# para realizar la estimación independiente de cada Eje
Eje1 <- NULL
Eje2 <- NULL
Eje3 <- NULL
e1 <- 0
e2 <- 0
e3 <- 0
for(i in 1:nrow(Qmat)){
if(Qmat$Eje[i]=="3 - FEM"){
e3 <- e3 + 1
Eje3[e3] <- Qmat$Item[i]
}else{
if(Qmat$Eje[i]=="2 - MI"){
e2 <- e2+1
Eje2[e2] <- Qmat$Item[i]
}else{
e1 <- e1+1
Eje1[e1] <- Qmat$Item[i]
}}}
Qmat$Item <- NULL
Qmat$Cod_Ram <- NULL         #Se cancelan las columnas innecesarias de la MatrizQ
Qmat$Eje <- NULL
Q_E1 <- Qmat[Eje1,1:12]
Q_E2 <- Qmat[Eje2,13:22]
Q_E3 <- Qmat[Eje3,23:30]
R_E1 <- Respuestas[,Eje1]
R_E2 <- Respuestas[,Eje2]
R_E3 <- Respuestas[,Eje3]
#View(Qmat)
setwd("C:/Users/Alejandro/Desktop/afchavez19/RIMEDIE/Mat09_2015/Post-Reunión25042018/DINO_Estimaciones")
####################################################
#############################################################
# Estimacion del modelo DINA para la aplicación de la prueba
# PLANEA ELCE 2015 con las especificaciones del modelo
# empleadas por el Dr. Guaner Rojas para la prueba PLANEA 06
#
#Se incluye también una versión más "rigida" del modelo
#############################################################
rm(list=ls())                       #
library("CDM")
setwd("C:/Users/Laboratorio 25/Desktop/afchavez-019/RIMEDIE/Mat09_2015/Post-Reunión25042018/DINA_Estimaciones")
Respuestas <- read.csv("PLANEA.09.2015_IDENT_ITEMS_ajustado.csv")
Respuestas$ESCUELA <- NULL
Respuestas$ID_ENT <- NULL
Respuestas$NOM_ENT <- NULL
Respuestas$ID_SERV <- NULL    #Se eliminan las columnas innecesarias
Respuestas$SERV <- NULL
Respuestas$MARGINC <- NULL
Respuestas$TAM_LOC_SEC <- NULL
Respuestas$SEXO <- NULL
Respuestas$EDAD_AC <- NULL
Respuestas$MES_NAC <- NULL
Respuestas$EDAD <- NULL
Respuestas$ï..ALUMNO <- NULL
Qmat <- read.csv("QMatriz_MAT09_ajustada.csv")
#Se utiliza la Matriz Q para identificar los reactivos que corresponden a cada Eje
# para realizar la estimación independiente de cada Eje
Eje1 <- NULL
Eje2 <- NULL
Eje3 <- NULL
e1 <- 0
e2 <- 0
e3 <- 0
for(i in 1:nrow(Qmat)){
if(Qmat$Eje[i]=="3 - FEM"){
e3 <- e3 + 1
Eje3[e3] <- Qmat$Item[i]
}else{
if(Qmat$Eje[i]=="2 - MI"){
e2 <- e2+1
Eje2[e2] <- Qmat$Item[i]
}else{
e1 <- e1+1
Eje1[e1] <- Qmat$Item[i]
}}}
Qmat$Item <- NULL
Qmat$Cod_Ram <- NULL         #Se cancelan las columnas innecesarias de la MatrizQ
Qmat$Eje <- NULL
Q_E1 <- Qmat[Eje1,1:12]
Q_E2 <- Qmat[Eje2,13:22]
Q_E3 <- Qmat[Eje3,23:30]
R_E1 <- Respuestas[,Eje1]
R_E2 <- Respuestas[,Eje2]
R_E3 <- Respuestas[,Eje3]
#View(Qmat)
setwd("C:/Users/Laboratorio 25/Desktop/afchavez-019/RIMEDIE/Mat09_2015/Post-Reunión25042018/DINO_Estimaciones")
####################################################
#EJE 1
d1 <- din(R_E1, q.matr = Q_E1, rule = "DINO",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d1$item, "E1SNPA_itempars_lax.csv")
write.csv(d1$skill.patt, "E1SNPA_skilpatt_lax.csv")
write.csv(data.frame(d1$pattern), "E1SNPA_postpattern_lax.csv",row.names = F)
#EJE 2
d2 <- din(R_E2, q.matr = Q_E2, rule = "DINO",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d2$item, "E2MI_itempars_lax.csv")
write.csv(d2$skill.patt, "E2MI_skilpatt_lax.csv")
write.csv(data.frame(d2$pattern), "E2MI_postpattern_lax.csv", row.names = F)
#EJE 3
d3 <- din(R_E3, q.matr = Q_E3, rule = "DINO",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d3$item, "E3FEM_itempars_lax.csv")
write.csv(d3$skill.patt, "E3FEM_skilpatt_lax.csv")
write.csv(data.frame(d3$pattern), "E3FEM_postpattern_lax.csv",row.names = F)
##########################
AICs <- c(d1$AIC, d2$AIC, d3$AIC)
AICs <- c("AIC", d1$AIC, d2$AIC, d3$AIC)
BICs <- c("BIC", d1$BIC, d2$BIC, d3$BIC)
AICs <- c("AIC", d1$AIC, d2$AIC, d3$AIC); AICs
BICs <- c("BIC", d1$BIC, d2$BIC, d3$BIC); BICs
d3$item
write.csv(AICs, "AIC.csv")
write.csv(BICs, "BIC.csv")
GOF <- as.data.frame(AICs)
GOF
GOF <- as.data.frame(c(1:3),AICs)
GOF <- as.data.frame(AICs)
GOF
GOF <- as.data.frame(c(AICs, BICs))
GOF
GOF <- data.frame(cbind(c(1:3),AICs, BICs))
GOF <- data.frame(cbind(AICs, BICs))
GOF
GOF <- data.frame(cbind(AICs, BICs))
GOF <- data.frame(cbind(c(1:3),AICs, BICs))
AICs <- c(d1$AIC, d2$AIC, d3$AIC); AICs
BICs <- c(d1$BIC, d2$BIC, d3$BIC); BICs
GOF <- data.frame(cbind(c(1:3), AICs, BICs))
GOF
GOF <- data.frame(cbind(c(1:3), AICs, BICs))
colnames(GOF) <- c("Eje", "AIC", "BIC")
write.csv(GOF, "GoF_DINO_aj.csv")
#############################################################
# Estimacion del modelo DINA para la aplicación de la prueba
# PLANEA ELCE 2015 con las especificaciones del modelo
# empleadas por el Dr. Guaner Rojas para la prueba PLANEA 06
#
#Se incluye también una versión más "rigida" del modelo
#############################################################
rm(list=ls())                       #
library("CDM")
setwd("C:/Users/Alejandro/Desktop/afchavez19/RIMEDIE/Mat09_2015/Post-Reunión25042018/DINA_Estimaciones")
Respuestas <- read.csv("PLANEA.09.2015_IDENT_ITEMS_ajustado.csv")
Respuestas$ESCUELA <- NULL
Respuestas$ID_ENT <- NULL
Respuestas$NOM_ENT <- NULL
Respuestas$ID_SERV <- NULL    #Se eliminan las columnas innecesarias
Respuestas$SERV <- NULL
Respuestas$MARGINC <- NULL
Respuestas$TAM_LOC_SEC <- NULL
Respuestas$SEXO <- NULL
Respuestas$EDAD_AC <- NULL
Respuestas$MES_NAC <- NULL
Respuestas$EDAD <- NULL
Respuestas$ï..ALUMNO <- NULL
Qmat <- read.csv("QMatriz_MAT09_ajustada.csv")
#Se utiliza la Matriz Q para identificar los reactivos que corresponden a cada Eje
# para realizar la estimación independiente de cada Eje
Eje1 <- NULL
Eje2 <- NULL
Eje3 <- NULL
e1 <- 0
e2 <- 0
e3 <- 0
for(i in 1:nrow(Qmat)){
if(Qmat$Eje[i]=="3 - FEM"){
e3 <- e3 + 1
Eje3[e3] <- Qmat$Item[i]
}else{
if(Qmat$Eje[i]=="2 - MI"){
e2 <- e2+1
Eje2[e2] <- Qmat$Item[i]
}else{
e1 <- e1+1
Eje1[e1] <- Qmat$Item[i]
}}}
Qmat$Item <- NULL
Qmat$Cod_Ram <- NULL         #Se cancelan las columnas innecesarias de la MatrizQ
Qmat$Eje <- NULL
Q_E1 <- Qmat[Eje1,1:12]
Q_E2 <- Qmat[Eje2,13:22]
Q_E3 <- Qmat[Eje3,23:30]
R_E1 <- Respuestas[,Eje1]
R_E2 <- Respuestas[,Eje2]
R_E3 <- Respuestas[,Eje3]
#View(Qmat)
###########################################################
# DINA
#EJE 1
d1 <- din(R_E1, q.matr = Q_E1, rule = "DINA",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d1$item, "E1SNPA_itempars_lax.csv")
write.csv(d1$skill.patt, "E1SNPA_skilpatt_lax.csv")
write.csv(data.frame(d1$pattern), "E1SNPA_fempostpattern_lax.csv",row.names = F)
#EJE 2
d2 <- din(R_E2, q.matr = Q_E2, rule = "DINA",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d2$item, "E2MI_itempars_lax.csv")
write.csv(d2$skill.patt, "E2MI_skilpatt_lax.csv")
write.csv(data.frame(d2$pattern), "E2MI_minpostpattern_lax.csv", row.names = F)
#EJE 3
d3 <- din(R_E3, q.matr = Q_E3, rule = "DINA",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d3$item, "E3FEM_itempars_lax.csv")
write.csv(d3$skill.patt, "E3FEM_skilpatt_lax.csv")
write.csv(data.frame(d3$pattern), "E3FEM_spapostpattern_lax.csv",row.names = F)
##########################
AICs <- c(d1$AIC, d2$AIC, d3$AIC); AICs
BICs <- c(d1$BIC, d2$BIC, d3$BIC); BICs
GOF <- data.frame(cbind(c(1:3), AICs, BICs))
colnames(GOF) <- c("Eje", "AIC", "BIC")
write.csv(GOF, "GoF_DINA_aj.csv")
#############################################################
# Estimacion del modelo DINA para la aplicación de la prueba
# PLANEA ELCE 2015 con las especificaciones del modelo
# empleadas por el Dr. Guaner Rojas para la prueba PLANEA 06
#
#Se incluye también una versión más "rigida" del modelo
#############################################################
rm(list=ls())                       #
library("CDM")
setwd("C:/Users/Laboratorio 25/Desktop/afchavez-019/RIMEDIE/Mat09_2015/Post-Reunión25042018/DINA_Estimaciones")
Respuestas <- read.csv("PLANEA.09.2015_IDENT_ITEMS_ajustado.csv")
Respuestas$ESCUELA <- NULL
Respuestas$ID_ENT <- NULL
Respuestas$NOM_ENT <- NULL
Respuestas$ID_SERV <- NULL    #Se eliminan las columnas innecesarias
Respuestas$SERV <- NULL
Respuestas$MARGINC <- NULL
Respuestas$TAM_LOC_SEC <- NULL
Respuestas$SEXO <- NULL
Respuestas$EDAD_AC <- NULL
Respuestas$MES_NAC <- NULL
Respuestas$EDAD <- NULL
Respuestas$ï..ALUMNO <- NULL
Qmat <- read.csv("QMatriz_MAT09_ajustada.csv")
#Se utiliza la Matriz Q para identificar los reactivos que corresponden a cada Eje
# para realizar la estimación independiente de cada Eje
Eje1 <- NULL
Eje2 <- NULL
Eje3 <- NULL
e1 <- 0
e2 <- 0
e3 <- 0
for(i in 1:nrow(Qmat)){
if(Qmat$Eje[i]=="3 - FEM"){
e3 <- e3 + 1
Eje3[e3] <- Qmat$Item[i]
}else{
if(Qmat$Eje[i]=="2 - MI"){
e2 <- e2+1
Eje2[e2] <- Qmat$Item[i]
}else{
e1 <- e1+1
Eje1[e1] <- Qmat$Item[i]
}}}
Qmat$Item <- NULL
Qmat$Cod_Ram <- NULL         #Se cancelan las columnas innecesarias de la MatrizQ
Qmat$Eje <- NULL
Q_E1 <- Qmat[Eje1,1:12]
Q_E2 <- Qmat[Eje2,13:22]
Q_E3 <- Qmat[Eje3,23:30]
R_E1 <- Respuestas[,Eje1]
R_E2 <- Respuestas[,Eje2]
R_E3 <- Respuestas[,Eje3]
#View(Qmat)
###########################################################
# DINA
#EJE 1
d1 <- din(R_E1, q.matr = Q_E1, rule = "DINA",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d1$item, "E1SNPA_itempars_lax.csv")
write.csv(d1$skill.patt, "E1SNPA_skilpatt_lax.csv")
write.csv(data.frame(d1$pattern), "E1SNPA_fempostpattern_lax.csv",row.names = F)
#EJE 2
d2 <- din(R_E2, q.matr = Q_E2, rule = "DINA",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d2$item, "E2MI_itempars_lax.csv")
write.csv(d2$skill.patt, "E2MI_skilpatt_lax.csv")
write.csv(data.frame(d2$pattern), "E2MI_minpostpattern_lax.csv", row.names = F)
#EJE 3
d3 <- din(R_E3, q.matr = Q_E3, rule = "DINA",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d3$item, "E3FEM_itempars_lax.csv")
write.csv(d3$skill.patt, "E3FEM_skilpatt_lax.csv")
write.csv(data.frame(d3$pattern), "E3FEM_spapostpattern_lax.csv",row.names = F)
##########################
AICs <- c(d1$AIC, d2$AIC, d3$AIC); AICs
BICs <- c(d1$BIC, d2$BIC, d3$BIC); BICs
GOF <- data.frame(cbind(c(1:3), AICs, BICs))
colnames(GOF) <- c("Eje", "AIC", "BIC")
write.csv(GOF, "GoF_DINA_aj.csv")
