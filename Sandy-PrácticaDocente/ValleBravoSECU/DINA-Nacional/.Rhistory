text(7,7.5, paste("Respondieron la Forma A:"), f=2)
text(7,7.1, paste(length(which(is.na(Dicot[,10])==FALSE)), " estudiantes en total"), f=2)
text(0.5,4, paste("0 estudiantes no asistieron"), srt=90, f=2)
text(7,6.5, paste("Promedio: 11.60"), f=2)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = "Puntuaciones - Forma A", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Todos los estudiantes)", line=0.5, cex=0.8, f=2)
axis(2,at=seq(0,8,1),labels=seq(0,8,1),las=1, line=-1.5)
axis(1,at=c(0.5:25.5),labels=c(0:25), line=-0.5, f=2)
for(i in 1:length(seq(0,25,1))){
valor_label[i] <- length(which(Score_FA==i))
if(valor_label[i]==0){
nada <- "nada"
}else{
text(i+0.5, valor_label[i]+0.35, paste(valor_label[i]), cex=1.2, f=2)
}}
valor_label <- NULL
hist(Score_FB,ann=F, breaks=seq(-0.1,25,1), axes=F, xlim=c(0,25), col="lightgoldenrod2",
ylim=c(0,8))
lines(c(0.9,0.9),c(0,8),col='black', lty=4,lwd=2)
text(7,7.5, paste("Respondieron la Forma B:"), f=2)
text(7,7.1, paste(length(which(is.na(Dicot[,46])==FALSE)), " estudiantes en total"), f=2)
text(0.3,4, paste(length(which(is.na(Dicot[,46])==TRUE)), " estudiante no asistió"), srt=90, f=2)
text(7,6.5, paste("Promedio: 5.92"), f=2)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = "Puntuaciones - Forma B", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Todos los estudiantes)", line=0.5, cex=0.8, f=2)
axis(2,at=seq(0,8,1),labels=seq(0,8,1),las=1, line=-1.2)
axis(1,at=seq(0.4,50.4,1),labels=c(0:50), line=-0.5, f=2)
for(i in 1:length(seq(0,25,1))){
valor_label[i] <- length(which(Score_FB==i))
if(valor_label[i]==0){
nada <- "nada"
}else{
text(i+0.4, valor_label[i]+0.35, paste(valor_label[i]), cex=1.2, f=2)
}}
Second_FB <- Score_FB+26
valor_label <- NULL
hist(c(Score_FA,Second_FB),ann=F, breaks=seq(-0.1,50,1), axes=F, xlim=c(0,50), col="lightgoldenrod4", ylim=c(0,8),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.125,0.125),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.25,.25),lwd=2,lty=3, col="black"),lines(c(0,1),c(.375,.375),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.5,.5),lwd=2,lty=3, col="black"),lines(c(0,1),c(.625,.625),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.75,.75),lwd=2,lty=3, col="black"),lines(c(0,1),c(.875,.875),lwd=2,lty=3, col="black")))
text(45.5, 15, "Forma 2", f=2, col="lightgoldenrod4", cex=2)
text(5.5, 15, "Forma 1", f=2, col="lightgoldenrod3", cex=2)
lines(c(25.9,25.9),c(0,8),col='black', lty=1,lwd=3)
lines(c(30.1,60),c(120,120),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(120,120),lty=1,lwd=4, col="lightgoldenrod1")
text(10.5,7.7, paste("Respondieron la Forma A:"), f=2)
text(10,7.3, paste(length(which(is.na(Dicot[,10])==FALSE)), " estudiantes en total"), f=2)
text(10,5.5, paste("Promedio: 11.6"), f=2)
text(40,7.7, paste("Respondieron la Forma B:"), f=2)
text(40,7.3, paste(length(which(is.na(Dicot[,46])==FALSE)), " estudiantes en total"), f=2)
text(40,5.5, paste("Promedio: 5.92"), f=2)
mtext(side=1, text = "Puntuaciones", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = "Puntuaciones - Formas A y B", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Todos los estudiantes)", line=0.5, cex=0.8, f=2)
axis(2,at=seq(0,8,1),labels=seq(0,8,1),las=1, line=-1.2)
axis(1,at=seq(0.4,51.4,1),labels=c(c(0:25),c(0:25)), line=-0.5, f=2)
Completo <- 0
Total_Completo <- NULL
for(a in 1:Sujetos){
if(is.na(Dicot[a,10])==FALSE&is.na(Dicot[a,50])==FALSE){
Completo <- Completo + 1
Total_Completo[Completo] <- Score_Total[a]
}else{
nada <- "nada"
}}
mark <- 0
valor_label <- NULL
hist(Total_Completo, breaks=seq(0,50,by=5), main="Puntajes totales", ann=F, axes=F, xlim=c(0,50),
col="goldenrod", ylim=c(0,12))
text(40,30, paste("Respondieron todo el examen:"), f=2)
text(40,29, paste(length(Total_Completo), " estudiantes en total"), f=2)
text(8,25, paste("Promedio: ", round(mean(Total_Completo),2)), f=2)
text(8,20.5, paste("Máxima: ", round(max(Total_Completo),2)), f=2)
text(8,22, paste("Mínima: ", round(min(Total_Completo),2)), f=2)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = "Puntuación TOTAL", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Contando sólo los estudiantes que hicieron ambas formas)", line=0.5, cex=0.8, f=2)
axis(2,at=seq(0,10,1),labels=seq(0,10,1),las=1, line=-1.5)
axis(1,at=seq(2.5,50,5),labels=c("0-5","5-10","11-15","16-20","21-25","26-30","31-35","36-40","41-45","46-50"), line=-0.5, f=2)
for(i in 1:length(seq(2.5,50,5))){
valor_label[i] <- length(which(Total_Completo>=(-4+(5 * i))&Total_Completo<((5*i)+1)))
text(2.5+mark, valor_label[i]+0.8, paste(valor_label[i]), cex=1.2, f=2)
mark <- mark+5
}
mark <- 0.5
valor_label <- NULL
hist(Total_Completo, breaks=seq(0,50,by=1), main="Puntajes totales", ann=F, axes=F,
xlim=c(0,50), col="goldenrod", ylim=c(0,4))
text(40,9, paste("Respondieron todo el examen:"), f=2)
text(40,8.5, paste(length(Total_Completo), " estudiantes en total"), f=2)
text(8,8, paste("Promedio: ", round(mean(Total_Completo),2)), f=2)
text(8,7.2, paste("Máxima: ", round(max(Total_Completo),2)), f=2)
text(8,6.8, paste("Mínima: ", round(min(Total_Completo),2)), f=2)
mtext(side=1, text = "Puntuación total", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = "Puntuación TOTAL", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Contando sólo los estudiantes que hicieron ambas formas)", line=0.5, cex=0.8, f=2)
axis(2,at=seq(0,4,1),labels=seq(0,4,1),las=1, line=-1.5)
axis(1,at=c(0.5:50.5),labels=c(1:51), line=.5, f=2)
for(i in 1:length(seq(0,50,1))){
valor_label[i] <- length(which(Total_Completo==i))
if(valor_label[i]==0){
nada <- "nada"
}else{
text(i-0.5, valor_label[i]+0.3, paste(valor_label[i]), cex=1.2, f=2)
}}
#Aciertos por item
Rights <- NULL
for(i in 1:Items){
Rights[i] <- sum(Dicot[,i+4], na.rm = TRUE)
}
valor_label <- 1.2
barplot(Rights, col="gray96", ann=F, axes=F, ylim=c(0,25))
axis(2,at=seq(0,25,5),labels=seq(0,25,5),las=1, line=-1.5)
text(32.5, 24, "Forma 2", f=2, col="lightgoldenrod4")
text(27.5, 24, "Forma 1", f=2, col="lightgoldenrod3")
lines(c(30.1,30.1),c(0,25),col='black', lty=1,lwd=1.3)
lines(c(30.1,60),c(25,25),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(25,25),lty=1,lwd=4, col="lightgoldenrod1")
mtext(side=3, text = "Tomando en cuenta la muestra total", line=0.5, cex=0.8, f=2)
mtext(side=3, text = "Número de estudiantes que acertaron cada item", line=1.5, cex=2, f=2)
mtext(side=1, text = "Item ID", line=2.5, cex=1.2, f=2)
axis(1,at=seq(.7,59.7,1.2),labels=seq(1,50,1), line=0, f=2,las=2)
for(i in 1:length(Rights)){
if(i==1){
text(0.7, Rights[i]+0.5, paste(Rights[i]), cex=1.1, f=2)
}else{
text(0.7+valor_label, Rights[i]+0.5, paste(Rights[i]), cex=1.1, f=2)
valor_label <- valor_label+1.2
}}
PRights <- NULL
for(i in 1:Items){
PRights[i] <- ((Rights[i])/Sujetos)*100
}
valor_label <- 1.2
barplot(PRights, col="gray96", ann=F, axes=F, ylim=c(0,100))
axis(2,at=seq(0,100,10),labels=paste(seq(0,100,10),"%"),las=1, line=-1.5)
text(32.5, 98, "Forma 2", f=2, col="lightgoldenrod4")
text(27.5, 98, "Forma 1", f=2, col="lightgoldenrod3")
lines(c(30.1,30.1),c(0,100),col='black', lty=1,lwd=1.3)
lines(c(30.1,60),c(100,100),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(100,100),lty=1,lwd=4, col="lightgoldenrod1")
mtext(side=3, text = "Tomando en cuenta la MUESTRA TOTAL", line=0.5, cex=0.8, f=2)
mtext(side=3, text = "Porcentaje de estudiantes que acertaron cada item", line=1.5, cex=2, f=2)
mtext(side=1, text = "Item ID", line=2.5, cex=1.2, f=2)
axis(1,at=seq(.7,59.7,1.2),labels=seq(1,50,1), line=0, f=2,las=2)
for(i in 1:length(PRights)){
if(i==1){
text(0.7, PRights[i]+6.5, paste(round(PRights[i],2),"%"), cex=1.1, f=2, srt=90)
}else{
text(0.7+valor_label, PRights[i]+6.5, paste(round(PRights[i],2),"%"), cex=1.1, f=2, srt=90)
valor_label <- valor_label+1.2
}}
#Indices de dificultad GLOBAL
P <- NULL
for(i in 1:Items){
P[i] <- mean(Dicot[,i+4],na.rm = TRUE)
}
hist(P,breaks = seq(0,1,0.05), col="firebrick2", xlab="", ann=F, axes=F,ylim = c(0,11))
axis(2,at=seq(0,11,1),labels=seq(0,11,1),las=1, line=-1.5)
mtext(side=3, text = "Porcentaje de estudiantes que acertaron cada item", line=0.5, cex=0.8, f=2)
mtext(side=3, text = "Dificultad de los ítems", line=1.5, cex=2, f=2)
mtext(side=2, text = "Frecuencia (No. de items)", line=0.5, cex=1.2, f=2)
axis(1,at=seq(0.025,1,0.05),labels=c("0 a 5%","6 a 10%","11 a 15%","16 a 20%","21 a 25%","26 a 30%","31 a 35%","36 a 40%","41 a 45%","46 a 50%","51 a 55%","56 a 60%","61 a 65%","66 a 70%","71 a 75%","76 a 80%","81 a 85%","86 a 90%","91 a 95%","96 a 100%"), line=0.1, f=2,las=2)
length(which(P<.4))
Dificiles <- c(which(P<.4))
Dificiles
#############################################################
# Codigo Para analizar los datos obtenidos por SCS
# calibrando con la base nacional del ELSEN 2015
# Codigo base elaborado por el Dr. Guaner Rojas Rojas
# modificado por Adriana Felisa Chávez
#
#El item PMB02 se omite del análisis porque no fue bien aplicado
#############################################################
rm(list=ls())                       #Limpiamos variables
library("CDM")
setwd("C:/Users/Alejandro/Desktop/afchavez19/Sandy-PrácticaDocente/ValleBravoSECU/DINA Cal-Nacional")
#Cargamos la base de ELSEN + 127 datos de Sandy SIN CONTAR el reactivo 22 (PMB02)
datos <- read.csv("Datos_Nacionales_Sandy.csv")
R_E1 <- datos[,c(c(1:8),c(26:34))]
R_E2 <- datos[,c(c(9:14),c(35:39))]
R_E3 <- datos[,c(c(15:25),c(40:50))]
#Segmentamos la Matriz Q subida por el Dr. Guaner en tres sub-matrices Q
qmat <- read.csv("MatrizQ_DrGuaner.csv")
Q_E1 <- qmat[1:17,1:12]
Q_E2 <- qmat[18:28,1:10]
Q_E3 <- qmat[29:50,1:13]
###################################
#############################################################
# Codigo Para analizar los datos obtenidos por SCS
# calibrando con la base nacional del ELSEN 2015
# Codigo base elaborado por el Dr. Guaner Rojas Rojas
# modificado por Adriana Felisa Chávez
#
#El item PMB02 se omite del análisis porque no fue bien aplicado
#############################################################
rm(list=ls())                       #Limpiamos variables
library("CDM")
setwd("C:/Users/Alejandro/Desktop/afchavez19/Sandy-PrácticaDocente/ValleBravoSECU/DINA-Nacional")
#Cargamos la base de ELSEN + 127 datos de Sandy SIN CONTAR el reactivo 22 (PMB02)
datos <- read.csv("Datos_Nacionales_Sandy.csv")
R_E1 <- datos[,c(c(1:8),c(26:34))]
R_E2 <- datos[,c(c(9:14),c(35:39))]
R_E3 <- datos[,c(c(15:25),c(40:50))]
#Segmentamos la Matriz Q subida por el Dr. Guaner en tres sub-matrices Q
qmat <- read.csv("MatrizQ_DrGuaner.csv")
Q_E1 <- qmat[1:17,1:12]
Q_E2 <- qmat[18:28,1:10]
Q_E3 <- qmat[29:50,1:13]
#############################################
# Se corren los modelos
# Los objetos DINA con mayúsculas corresponden al código de Fel
# Los objetos d1, d2 y d3 corresponden al codigo del Dr. Guaner
# Por cada estimación se guardan:
# Las estimaciones paramétricas (itemparameters)
# El nivel de habilidad estimado para toda la muestra (skilpatterns)
# Las estimaciones individuales (postpattern)
d1 <- din(R_E1, q.matr = Q_E1, rule = "DINA",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d1$item, "e1_itempars_fem_DINA-Guaner.csv")
write.csv(d1$skill.patt, "e1_skilpatt_fem_DINA-Guaner.csv")
write.csv(data.frame(d1$pattern), "e1_fempostpattern_DINA-Guaner.csv",row.names = F)
d2 <- din(R_E2, q.matr = Q_E2, rule = "DINA",
conv.crit = 0.01, maxit = 500, progress = TRUE)
write.csv(d2$item, "e2_itempars_min_DINA-Guaner.csv")
write.csv(d2$skill.patt, "e2_skilpatt_min_DINA-Guaner.csv")
write.csv(data.frame(d2$pattern), "e2_minpostpattern_DINA-Guaner.csv", row.names = F)
d3 <- din(R_E3, q.matr = Q_E3, rule = "DINA",
conv.crit = 0.1, maxit = 50, progress = TRUE)
write.csv(d3$item, "e3_itempars_spa_DINA-Guaner.csv")
write.csv(d3$skill.patt, "e3_skilpatt_spa_DINA-Guaner.csv")
write.csv(data.frame(d3$pattern), "e3_spapostpattern_DINA-Guaner.csv",row.names = F)
rm(list=ls())                       #Limpiamos variables
setwd("C:/Users/Alejandro/Desktop/afchavez19/Sandy-PrácticaDocente/ValleBravoSECU/DINA-Nacional")
#Base de referencia
datos <- read.csv("Datos_Nacionales_Sandy.csv")
#Identificamos el lugar que ocupa cada uno de nuestros sujetos de interés en la matriz Nacional
ValleBravo <- which(datos$ESCUELA=="Valle")
############# Estimaciones NACIONALES por habilidad  ################################
#####################################################################################
#skill_total <- read.csv("E1_FEM_skilpatterns_Fel.csv")
skill_total <- read.csv("e1_skilpatt_fem_DINA-Guaner.csv")
skill_nacional <- skill_total$skill.prob
############ Estimaciones por SUJETO
#pattern_individual <- read.csv("E1_FEM_postpattern_Fel.csv")
pattern_individual <- read.csv("e1_fempostpattern_DINA-Guaner.csv")
pattern_individual <- pattern_individual[,6:17]
############ Estimación paramétrica del modelo
#parameter_estimation <- read.csv("E1_FEM_itemparameters_Fel.csv")
parameter_estimation <- read.csv("e1_itempars_fem_DINA-Guaner.csv")     #Just in case
#####################################################################################
skill_e1 <- NULL
for(attribute in 1:11){
skill_e1[attribute] <- mean(pattern_individual[ValleBravo,attribute])
}
#col_sk1 <- ifelse(skill_e1>0.5, "lightsteelblue1", "lightsteelblue3")
col_sk1 <- ifelse(skill_e1<0.3, "brown4", ifelse(skill_e1<0.7,"gold3","darkseagreen3"))
q1 <- c("H101","H102","H103","H104","H105","H106","H107","H109","H110","H111","H112")
valor_label <- 11.7
valor_dot <- 11.7
barplot(rev(skill_e1), horiz=TRUE, ann=FALSE, axes=FALSE, xlim=c(0,1), space=0.1, col=rev(col_sk1), ylim=c(0,13),
panel.first =
c(lines(c(0.1,0.1),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(0.2,0.2),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.3,0.3),c(0,0.97),lwd=3,lty=1, col="gold4"),lines(c(0.4,0.4),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.5,0.5),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(0.6,0.6),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.7,0.7),c(0,0.97),lwd=3,lty=1, col="darkseagreen4"),lines(c(0.8,0.8),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.9,0.9),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(1,1),c(0,0.97),lwd=1,lty=3, col="black")))
mtext(side=1, text = "Dominio de la habilidad", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Habilidad", line=1, cex=1.8, f=2)
mtext(side=3, text = "Eje 1: Espacio, Forma y Medida", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Todos los estudiantes)", line=0.5, cex=1.1, f=2)
text(0.15,12.55, "En construcción", f=2, cex=0.8, col="black")
text(0.45,12.55, "En desarrollo", f=2, cex=0.8, col="black")
text(0.85,12.55, "En consolidación", f=2, cex=0.8, col="black")
lines(c(0.05,0.09),c(12.5,12.5), col="brown4", lwd=4)
lines(c(.35,.39),c(12.5,12.5), col="gold3", lwd=4)
lines(c(.75,.79),c(12.5,12.5), col="darkseagreen3", lwd=4)
axis(1,at=seq(0,1,0.1),labels=seq(0,1,0.1), line=0.5, f=2)
for(i in 1:length(seq(1,11,1))){
text(0.03,valor_label, paste(q1[i]), f=2, cex=1.2)
col_comp <- ifelse(skill_e1[i]>skill_nacional[i], "darkblue", "darkred")
points(skill_nacional[i],valor_dot, pch=3, cex=1.5, lwd=4, col=col_comp)
text(0.14,valor_dot, paste("Media nacional: ", round(skill_nacional[i],3)), f=2, cex=0.8, col=col_comp)
text(skill_e1[i]+.05,valor_label, paste(round(skill_e1[i],3)), f=2, cex=1.2)
valor_dot <- valor_dot - 1.1
valor_label <- valor_label - 1.1}
rm(list=ls())                       #Limpiamos variables
setwd("C:/Users/Alejandro/Desktop/afchavez19/Sandy-PrácticaDocente/ValleBravoSECU/DINA-Nacional")
#Base de referencia
datos <- read.csv("Datos_Nacionales_Sandy.csv")
#Identificamos el lugar que ocupa cada uno de nuestros sujetos de interés en la matriz Nacional
ValleBravo <- which(datos$ESCUELA=="ValleSECU")
############# Estimaciones NACIONALES por habilidad  ################################
#####################################################################################
#skill_total <- read.csv("E1_FEM_skilpatterns_Fel.csv")
skill_total <- read.csv("e1_skilpatt_fem_DINA-Guaner.csv")
skill_nacional <- skill_total$skill.prob
############ Estimaciones por SUJETO
#pattern_individual <- read.csv("E1_FEM_postpattern_Fel.csv")
pattern_individual <- read.csv("e1_fempostpattern_DINA-Guaner.csv")
pattern_individual <- pattern_individual[,6:17]
############ Estimación paramétrica del modelo
#parameter_estimation <- read.csv("E1_FEM_itemparameters_Fel.csv")
parameter_estimation <- read.csv("e1_itempars_fem_DINA-Guaner.csv")     #Just in case
#####################################################################################
skill_e1 <- NULL
for(attribute in 1:11){
skill_e1[attribute] <- mean(pattern_individual[ValleBravo,attribute])
}
#col_sk1 <- ifelse(skill_e1>0.5, "lightsteelblue1", "lightsteelblue3")
col_sk1 <- ifelse(skill_e1<0.3, "brown4", ifelse(skill_e1<0.7,"gold3","darkseagreen3"))
q1 <- c("H101","H102","H103","H104","H105","H106","H107","H109","H110","H111","H112")
valor_label <- 11.7
valor_dot <- 11.7
barplot(rev(skill_e1), horiz=TRUE, ann=FALSE, axes=FALSE, xlim=c(0,1), space=0.1, col=rev(col_sk1), ylim=c(0,13),
panel.first =
c(lines(c(0.1,0.1),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(0.2,0.2),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.3,0.3),c(0,0.97),lwd=3,lty=1, col="gold4"),lines(c(0.4,0.4),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.5,0.5),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(0.6,0.6),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.7,0.7),c(0,0.97),lwd=3,lty=1, col="darkseagreen4"),lines(c(0.8,0.8),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.9,0.9),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(1,1),c(0,0.97),lwd=1,lty=3, col="black")))
mtext(side=1, text = "Dominio de la habilidad", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Habilidad", line=1, cex=1.8, f=2)
mtext(side=3, text = "Eje 1: Espacio, Forma y Medida", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Todos los estudiantes)", line=0.5, cex=1.1, f=2)
text(0.15,12.55, "En construcción", f=2, cex=0.8, col="black")
text(0.45,12.55, "En desarrollo", f=2, cex=0.8, col="black")
text(0.85,12.55, "En consolidación", f=2, cex=0.8, col="black")
lines(c(0.05,0.09),c(12.5,12.5), col="brown4", lwd=4)
lines(c(.35,.39),c(12.5,12.5), col="gold3", lwd=4)
lines(c(.75,.79),c(12.5,12.5), col="darkseagreen3", lwd=4)
axis(1,at=seq(0,1,0.1),labels=seq(0,1,0.1), line=0.5, f=2)
for(i in 1:length(seq(1,11,1))){
text(0.03,valor_label, paste(q1[i]), f=2, cex=1.2)
col_comp <- ifelse(skill_e1[i]>skill_nacional[i], "darkblue", "darkred")
points(skill_nacional[i],valor_dot, pch=3, cex=1.5, lwd=4, col=col_comp)
text(0.14,valor_dot, paste("Media nacional: ", round(skill_nacional[i],3)), f=2, cex=0.8, col=col_comp)
text(skill_e1[i]+.05,valor_label, paste(round(skill_e1[i],3)), f=2, cex=1.2)
valor_dot <- valor_dot - 1.1
valor_label <- valor_label - 1.1}
rm(list=ls())                       #Limpiamos variables
library("CDM")
setwd("C:/Users/Adriana/Desktop/afchavez-019/Sandy-PrácticaDocente/ValleBravoSECU/DINA-Nacional")
#Base de referencia
datos <- read.csv("Datos_Nacionales_Sandy.csv")
#Identificamos el lugar que ocupa cada uno de nuestros sujetos de interés en la matriz Nacional
ValleBravo <- which(datos$ESCUELA=="ValleSECU")
############# Estimaciones NACIONALES por habilidad  ################################
#####################################################################################
skill_total <- read.csv("e2_skilpatt_min_DINA-Guaner.csv")
skill_nacional <- skill_total$skill.prob
############ Estimaciones por SUJETO
#pattern_individual <- read.csv("E2_MI_postpattern_Fel.csv")
pattern_individual <- read.csv("e2_minpostpattern_DINA-Guaner.csv")
pattern_individual <- pattern_individual[,6:15]
############ Estimación paramétrica del modelo
#parameter_estimation <- read.csv("E2_MI_itemparameters_Fel.csv")
parameter_estimation <- read.csv("e2_itempars_min_DINA-Guaner.csv")     #Just in case
#####################################################################################
skill_e2 <- NULL
for(attribute in 1:10){
skill_e2[attribute] <- mean(pattern_individual[ValleBravo,attribute])
}
#col_sk2 <- ifelse(skill_e2_Lancaster>0.5, "lightsalmon1", "lightsalmon4")
col_sk2 <- ifelse(skill_e2<0.3, "brown4", ifelse(skill_e2<0.7,"gold3","darkseagreen3"))
q2 <- c("H201","H202","H203","H204","H205","H206","H207","H208","H209","H210")
valor_label <- 10.6
valor_dot <- 10.6
barplot(rev(skill_e2), horiz=TRUE, ann=FALSE, axes=FALSE, xlim=c(0,1), space=0.1, col=rev(col_sk2), ylim=c(0,12),
panel.first =
c(lines(c(0.1,0.1),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(0.2,0.2),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.3,0.3),c(0,0.97),lwd=3,lty=1, col="gold3"),lines(c(0.4,0.4),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.5,0.5),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(0.6,0.6),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.7,0.7),c(0,0.97),lwd=3,lty=1, col="darkseagreen3"),lines(c(0.8,0.8),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.9,0.9),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(1,1),c(0,0.97),lwd=1,lty=3, col="black")))
mtext(side=1, text = "Dominio de la habilidad", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Habilidad", line=1, cex=1.8, f=2)
mtext(side=3, text = "Eje 2: Manejo de la Información", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Todos los estudiantes)", line=0.5, cex=1.1, f=2)
text(0.15,11.55, "En construcción", f=2, cex=0.8, col="black")
text(0.45,11.55, "En desarrollo", f=2, cex=0.8, col="black")
text(0.85,11.55, "En consolidación", f=2, cex=0.8, col="black")
lines(c(0.05,0.09),c(11.5,11.5), col="brown4", lwd=4)
lines(c(.35,.39),c(11.5,11.5), col="gold3", lwd=4)
lines(c(.75,.79),c(11.5,11.5), col="darkseagreen3", lwd=4)
axis(1,at=seq(0,1,0.1),labels=seq(0,1,0.1), line=-0.5, f=2)
for(i in 1:length(seq(1,10,1))){
text(0.04,valor_label, paste(q2[i]), f=2, cex=1.2)
col_comp <- ifelse(skill_e2[i]>skill_nacional[i], "darkblue", "darkred")
points(skill_nacional[i],valor_dot, pch=3, cex=1.5, lwd=4, col=col_comp)
text(0.19,valor_dot, paste("Media nacional: ", round(skill_nacional[i],3)), f=2, cex=0.8, col=col_comp)
text(skill_e2[i]+.06,valor_label, paste(round(skill_e2[i],3)), f=2, cex=1.2)
valor_dot <- valor_dot - 1.1
valor_label <- valor_label - 1.1}
rm(list=ls())                       #Limpiamos variables
library("CDM")
setwd("C:/Users/Alejandro/Desktop/afchavez19/Sandy-PrácticaDocente/ValleBravoSECU/DINA-Nacional")
#Base de referencia
datos <- read.csv("Datos_Nacionales_Sandy.csv")
#Identificamos el lugar que ocupa cada uno de nuestros sujetos de interés en la matriz Nacional
ValleBravo <- which(datos$ESCUELA=="ValleSECU")
############# Estimaciones NACIONALES por habilidad  ################################
#####################################################################################
skill_total <- read.csv("e2_skilpatt_min_DINA-Guaner.csv")
skill_nacional <- skill_total$skill.prob
############ Estimaciones por SUJETO
#pattern_individual <- read.csv("E2_MI_postpattern_Fel.csv")
pattern_individual <- read.csv("e2_minpostpattern_DINA-Guaner.csv")
pattern_individual <- pattern_individual[,6:15]
############ Estimación paramétrica del modelo
#parameter_estimation <- read.csv("E2_MI_itemparameters_Fel.csv")
parameter_estimation <- read.csv("e2_itempars_min_DINA-Guaner.csv")     #Just in case
#####################################################################################
skill_e2 <- NULL
for(attribute in 1:10){
skill_e2[attribute] <- mean(pattern_individual[ValleBravo,attribute])
}
#col_sk2 <- ifelse(skill_e2_Lancaster>0.5, "lightsalmon1", "lightsalmon4")
col_sk2 <- ifelse(skill_e2<0.3, "brown4", ifelse(skill_e2<0.7,"gold3","darkseagreen3"))
q2 <- c("H201","H202","H203","H204","H205","H206","H207","H208","H209","H210")
valor_label <- 10.6
valor_dot <- 10.6
barplot(rev(skill_e2), horiz=TRUE, ann=FALSE, axes=FALSE, xlim=c(0,1), space=0.1, col=rev(col_sk2), ylim=c(0,12),
panel.first =
c(lines(c(0.1,0.1),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(0.2,0.2),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.3,0.3),c(0,0.97),lwd=3,lty=1, col="gold3"),lines(c(0.4,0.4),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.5,0.5),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(0.6,0.6),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.7,0.7),c(0,0.97),lwd=3,lty=1, col="darkseagreen3"),lines(c(0.8,0.8),c(0,0.97),lwd=1,lty=3, col="black"),
lines(c(0.9,0.9),c(0,0.97),lwd=1,lty=3, col="black"),lines(c(1,1),c(0,0.97),lwd=1,lty=3, col="black")))
mtext(side=1, text = "Dominio de la habilidad", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Habilidad", line=1, cex=1.8, f=2)
mtext(side=3, text = "Eje 2: Manejo de la Información", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Todos los estudiantes)", line=0.5, cex=1.1, f=2)
text(0.15,11.55, "En construcción", f=2, cex=0.8, col="black")
text(0.45,11.55, "En desarrollo", f=2, cex=0.8, col="black")
text(0.85,11.55, "En consolidación", f=2, cex=0.8, col="black")
lines(c(0.05,0.09),c(11.5,11.5), col="brown4", lwd=4)
lines(c(.35,.39),c(11.5,11.5), col="gold3", lwd=4)
lines(c(.75,.79),c(11.5,11.5), col="darkseagreen3", lwd=4)
axis(1,at=seq(0,1,0.1),labels=seq(0,1,0.1), line=-0.5, f=2)
for(i in 1:length(seq(1,10,1))){
text(0.04,valor_label, paste(q2[i]), f=2, cex=1.2)
col_comp <- ifelse(skill_e2[i]>skill_nacional[i], "darkblue", "darkred")
points(skill_nacional[i],valor_dot, pch=3, cex=1.5, lwd=4, col=col_comp)
text(0.19,valor_dot, paste("Media nacional: ", round(skill_nacional[i],3)), f=2, cex=0.8, col=col_comp)
text(skill_e2[i]+.06,valor_label, paste(round(skill_e2[i],3)), f=2, cex=1.2)
valor_dot <- valor_dot - 1.1
valor_label <- valor_label - 1.1}
rm(list=ls())                       #Limpiamos variables
library("CDM")
setwd("C:/Users/Alejandro/Desktop/afchavez19/Sandy-PrácticaDocente/ValleBravoSECU/DINA-Nacional")
#Base de referencia
datos <- read.csv("Datos_Nacionales_Sandy.csv")
#Identificamos el lugar que ocupa cada uno de nuestros sujetos de interés en la matriz Nacional
ValleBravo <- which(datos$ESCUELA=="ValleSECU")
############# Estimaciones NACIONALES por habilidad  ################################
#####################################################################################
#skill_total <- read.csv("E3_SNPA_skilpatterns_Fel.csv")
skill_total <- read.csv("e3_skilpatt_spa_DINA-Guaner.csv")
skill_nacional <- skill_total$skill.prob
############ Estimaciones por SUJETO
#pattern_individual <- read.csv("E3_SNPA_postpattern_Fel.csv")
pattern_individual <- read.csv("e3_spapostpattern_DINA-Guaner.csv")
pattern_individual <- pattern_individual[,6:18]
############ Estimación paramétrica del modelo
#parameter_estimation <- read.csv("E3_SNPA_itemparameters_Fel.csv")
parameter_estimation <- read.csv("e3_itempars_spa_DINA-Guaner.csv")     #Just in case
#####################################################################################
skill_e3 <- NULL
for(attribute in 1:13){
skill_e3[attribute] <- mean(pattern_individual[ValleBravo,attribute])
}
#col_sk3 <- ifelse(skill_e3_Lancaster>0.5, "palegreen3", "palegreen4")
col_sk3 <- ifelse(skill_e3<0.3, "brown4", ifelse(skill_e3<0.7,"gold3","darkseagreen3"))
q3 <- c("H301","H302","H303","H304","H305","H306","H307","H308","H309","H310","H311","H312", "H313")
valor_label <- 13.9
valor_dot <- 13.9
barplot(rev(skill_e3), horiz=TRUE, ann=FALSE, axes=FALSE, xlim=c(0,1), space=0.1, col=rev(col_sk3), ylim=c(1,15),
panel.first =
c(lines(c(0.1,0.1),c(-0.07,0.97),lwd=1,lty=3, col="black"),lines(c(0.2,0.2),c(-0.07,0.97),lwd=1,lty=3, col="black"),
lines(c(0.3,0.3),c(-0.07,0.97),lwd=3,lty=1, col="gold3"),lines(c(0.4,0.4),c(-0.07,0.97),lwd=1,lty=3, col="black"),
lines(c(0.5,0.5),c(-0.07,0.97),lwd=1,lty=3, col="black"),lines(c(0.6,0.6),c(-0.07,0.97),lwd=1,lty=3, col="black"),
lines(c(0.7,0.7),c(-0.07,0.97),lwd=3,lty=1, col="darkseagreen3"),lines(c(0.8,0.8),c(-0.07,0.97),lwd=1,lty=3, col="black"),
lines(c(0.9,0.9),c(-0.07,.97),lwd=1,lty=3, col="black"),lines(c(1,1),c(-0.07,0.97),lwd=1,lty=3, col="black")))
mtext(side=1, text = "Dominio de la habilidad", line=3.5, cex=1.3, f=2)
mtext(side=2, text = "Habilidad", line=1, cex=1.8, f=2)
mtext(side=3, text = "Eje 3: Sentido Numérico y Pensamiento Algebraico", line=1.5, cex=2, f=2)
mtext(side=3, text = "(Todos los estudiantes)", line=0.5, cex=1.1, f=2)
text(0.15,15, "En construcción", f=2, cex=0.8, col="black")
text(0.45,15, "En desarrollo", f=2, cex=0.8, col="black")
text(0.85,15, "En consolidación", f=2, cex=0.8, col="black")
lines(c(0.05,0.09),c(15,15), col="brown4", lwd=4)
lines(c(.35,.39),c(15,15), col="gold3", lwd=4)
lines(c(.75,.79),c(15,15), col="darkseagreen3", lwd=4)
axis(1,at=seq(0,1,0.1),labels=seq(0,1,0.1), line=1, f=2)
for(i in 1:length(seq(1,13,1))){
text(0.04,valor_label, paste(q3[i]), f=2, cex=1.2)
col_comp <- ifelse(skill_e3[i]>skill_nacional[i], "darkblue", "darkred")
points(skill_nacional[i],valor_dot, pch=3, cex=1.5, lwd=4, col=col_comp)
text(0.19,valor_dot, paste("Media nacional: ", round(skill_nacional[i],3)), f=2, cex=0.8, col=col_comp)
text(skill_e3[i]+.06,valor_label, paste(round(skill_e3[i],3)), f=2, cex=1.2)
valor_dot <- valor_dot - 1.1
valor_label <- valor_label - 1.1}
