%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Template graphical model %
% Author: Tom Lodewyckx    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% 0. Begin document
%%%%%%%%%%%%%%%%%%%

\documentclass{article}
\usepackage[paperwidth=10.5in, paperheight=7in]{geometry}
\usepackage{pst-all,pstricks,pst-tools}
\usepackage{com.braju.graphicalmodels}
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\catcode`\@=11%
\pagestyle{empty}
\begin{document}
\TeXtoEPS
\psset{unit=13mm,arrowscale=1.5}
\SpecialCoor


% 1. Grid
%%%%%%%%%

\begin{pspicture}(2,0)(12,10)
%\showgrid


% 2. Nodes
%%%%%%%%%%


\rput(3.5,8.2){\GM@node[nodeSize=15mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{GeneralTheta}}
				\GM@label[offset=-3.5mm]{GeneralTheta}{\huge$\theta_{i}$}

\rput(7,8.2){\GM@node[nodeSize=15mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{Delta}}
				\GM@label[offset=-2.5mm]{Delta}{\huge$\delta_{i}$}



     
           
\rput(3.5,6){\GM@node[nodeSize=17mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{tA}}
					\rput(3.5,6){\GM@node[nodeSize=14mm]{Q_small}}
           \GM@label[offset=-4mm]{tA}{\huge$\theta^A_{i}$}

\rput(7,6){\GM@node[nodeSize=17mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{tB}}
					\rput(7,6){\GM@node[nodeSize=14mm]{Q_small}}
           \GM@label[offset=-4mm]{tB}{\huge$\theta^B_{i}$}


        

\rput(3.5,4){\GM@node[nodeSize=14mm,
					observed=true,
					observedColor=lightgray,
					query=true
					]{countsA}}
           \GM@label[offset=-4.5mm]{countsA}{\huge$y^A_{i}$}       

\rput(7,4){\GM@node[nodeSize=15mm,
					observed=true,
					observedColor=lightgray,
					query=true
					]{countsB}}
           \GM@label[offset=-6mm]{countsB}{\huge$y^B_{i}$}    

 


\rput(3.5,2){\GM@node[nodeSize=13mm,
					observed=true,
					observedColor=lightgray,
					query=true
					]{nA}}
           \GM@label[offset=-3.5mm]{nA}{\huge$n^A$} 

\rput(7,2){\GM@node[nodeSize=13mm,
					observed=true,
					observedColor=lightgray,
					query=true
					]{nB}}
           \GM@label[offset=-3.5mm]{nB}{\huge$n^B$}    




 
 
% 3. Arrows
%%%%%%%%%%%

\ncline[arrows=->]{GeneralTheta}{tA}
\ncline[arrows=->]{GeneralTheta}{tB}
\ncline[arrows=->]{Delta}{tA}
\ncline[arrows=->]{Delta}{tB}

\ncline[arrows=->]{tA}{countsA}
\ncline[arrows=->]{tB}{countsB}

\ncline[arrows=->]{nA}{countsA}
\ncline[arrows=->]{nB}{countsB}

% 4. Plates
%%%%%%%%%%%

\rput(1.3, 0.7){\GM@plate[plateLabelPos=br]{8.2}{8.6}{\Large$i$ Stimuli (Signal or Noise)}}

% 5. Model specification
%%%%%%%%%%%%%%%%%%%%%%%%

%\rput(11.5,8.5){\pnode{equation}}\GM@label{equation}{\huge$\epsilon_{i}\sim \mathrm{Lognorm}\bigl(0,1\bigr)$}


\rput(11.5,10){\pnode{equation}}\GM@label{equation}{\huge$\theta_{h} \sim \mathrm{Uniform}(0.5,1)$}

\rput(11.5,9){\pnode{equation}}\GM@label{equation}{\huge$\theta_{fa} \sim \mathrm{Uniform}(0,0.5)$}

\rput(11.5,8){\pnode{equation}}\GM@label{equation}{\huge$\delta \sim \mathrm{Uniform}(0,0.5)$}


\rput(11.5,6.5){\pnode{equation}}\GM@label{equation}{\huge$\theta^A_{h} \gets \theta_{i} + \frac{\delta}{2}$}

\rput(11.5,5.5){\pnode{equation}}\GM@label{equation}{\huge$\theta^B_{h} \gets \theta_{i} - \frac{\delta}{2}$}

\rput(11.5,4.5){\pnode{equation}}\GM@label{equation}{\huge$\theta^A_{fa} \gets \theta_{i} - \frac{\delta}{2}$}

\rput(11.5,3.5){\pnode{equation}}\GM@label{equation}{\huge$\theta^B_{fa} \gets \theta_{i} + \frac{\delta}{2}$}



\rput(11.5,2){\pnode{equation}}\GM@label{equation}{\huge$K^A_{i}\sim \mathrm{Binomial}(\theta^A_{i}, n^A)$}

\rput(11.5,1){\pnode{equation}}\GM@label{equation}{\huge$Fa_{ij}\sim \mathrm{Binomial}(\theta^B_{i}, n^B)$}










% 6. End document
%%%%%%%%%%%%%%%%%

\end{pspicture}
\endTeXtoEPS
\end{document}