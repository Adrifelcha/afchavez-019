%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Template graphical model %
% Author: Tom Lodewyckx    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% 0. Begin document
%%%%%%%%%%%%%%%%%%%

\documentclass{article}
\usepackage[paperwidth=10.5in, paperheight=7in]{geometry}
\usepackage{pst-all,pstricks,pst-tools}
\usepackage{com.braju.graphicalmodels}
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\catcode`\@=11%
\pagestyle{empty}
\begin{document}
\TeXtoEPS
\psset{unit=13mm,arrowscale=1.5}
\SpecialCoor


% 1. Grid
%%%%%%%%%

\begin{pspicture}(2,0)(12,10)
%\showgrid


% 2. Nodes
%%%%%%%%%%


\rput(3.6,9.5){\GM@node[nodeSize=15mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{GeneralTheta}}
				\GM@label[offset=-3.5mm]{GeneralTheta}{\huge$\mu_{i}$}

\rput(7.4,9.5){\GM@node[nodeSize=15mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{Delta}}
				\GM@label[offset=-2.5mm]{Delta}{\huge$\delta_{i}$}


\rput(2.5,7){\GM@node[nodeSize=17mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{MuA}}
				\rput(2.5,7){\GM@node[nodeSize=14mm]{Q_small}}
				\GM@label[offset=-3.5mm]{MuA}{\huge$\mu^A_{i}$}

\rput(4.5,7){\GM@node[nodeSize=15mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{SigmaA}}
				\GM@label[offset=-3.5mm]{SigmaA}{\huge$\sigma^A_{i}$}
\rput(6.5,7){\GM@node[nodeSize=17mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{MuB}}
				\rput(6.5,7){\GM@node[nodeSize=14mm]{Q_small}}
				\GM@label[offset=-3.5mm]{MuB}{\huge$\mu^B_{i}$}

\rput(8,7){\GM@node[nodeSize=15mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{SigmaB}}
				\GM@label[offset=-3.5mm]{SigmaB}{\huge$\sigma^B_{i}$}



     
           
\rput(3.5,5){\GM@node[nodeSize=14mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{tA}}
           \GM@label[offset=-4mm]{tA}{\huge$\theta^A_{i}$}

\rput(7,5){\GM@node[nodeSize=14mm,
					%observed=true,
					observedColor=lightgray,
					%query=true
					]{tB}}
           \GM@label[offset=-4mm]{tB}{\huge$\theta^B_{i}$}


        

\rput(3.5,3){\GM@node[nodeSize=14mm,
					observed=true,
					observedColor=lightgray,
					query=true
					]{countsA}}
           \GM@label[offset=-4.5mm]{countsA}{\huge$y^A_{i}$}       

\rput(7,3){\GM@node[nodeSize=15mm,
					observed=true,
					observedColor=lightgray,
					query=true
					]{countsB}}
           \GM@label[offset=-4.5mm]{countsB}{\huge$y^B_{i}$}    

 


\rput(3.5,1){\GM@node[nodeSize=13mm,
					observed=true,
					observedColor=lightgray,
					query=true
					]{nA}}
           \GM@label[offset=-3.5mm]{nA}{\huge$n^A$} 

\rput(7,1){\GM@node[nodeSize=13mm,
					observed=true,
					observedColor=lightgray,
					query=true
					]{nB}}
           \GM@label[offset=-3.5mm]{nB}{\huge$n^B$}    




 
 
% 3. Arrows
%%%%%%%%%%%

\ncline[arrows=->]{GeneralTheta}{MuA}
\ncline[arrows=->]{GeneralTheta}{MuB}
\ncline[arrows=->]{Delta}{MuA}
\ncline[arrows=->]{Delta}{MuB}

\ncline[arrows=->]{MuA}{tA}
\ncline[arrows=->]{SigmaA}{tA}
\ncline[arrows=->]{MuB}{tB}
\ncline[arrows=->]{SigmaB}{tB}


\ncline[arrows=->]{tA}{countsA}
\ncline[arrows=->]{tB}{countsB}
\ncline[arrows=->]{nA}{countsA}
\ncline[arrows=->]{nB}{countsB}

% 4. Plates
%%%%%%%%%%%

\rput(1.4, 0){\GM@plate[plateLabelPos=br]{8.2}{8.4}{\Large$j$ participant}}
\rput(1.1, -0.5){\GM@plate[plateLabelPos=br]{8.9}{10.8}{\Large$i$ stimuli (signal or noise)}}

% 5. Model specification
%%%%%%%%%%%%%%%%%%%%%%%%

%\rput(11.5,8.5){\pnode{equation}}\GM@label{equation}{\huge$\epsilon_{i}\sim \mathrm{Lognorm}\bigl(0,1\bigr)$}


\rput(11.5,11.5){\pnode{equation}}\GM@label{equation}{\huge$\mu_{h} \sim \mathrm{Uniform}(0.5,1)$}

\rput(11.5,10.5){\pnode{equation}}\GM@label{equation}{\huge$\mu_{fa} \sim \mathrm{Uniform}(0,0.5)$}

\rput(11.5,9.5){\pnode{equation}}\GM@label{equation}{\huge$\delta \sim \mathrm{Uniform}(0,0.5)$}


\rput(11.5,8.2){\pnode{equation}}\GM@label{equation}{\huge$\mu^A_{h} \gets \mu_{h} + \frac{\delta}{2}$}

\rput(11.5,7.2){\pnode{equation}}\GM@label{equation}{\huge$\mu^B_{h} \gets \mu_{h} - \frac{\delta}{2}$}

\rput(11.5,6.2){\pnode{equation}}\GM@label{equation}{\huge$\mu^A_{fa} \gets \mu_{fa} - \frac{\delta}{2}$}

\rput(11.5,5.2){\pnode{equation}}\GM@label{equation}{\huge$\mu^B_{fa} \gets \mu_{fa} + \frac{\delta}{2}$}

\rput(11.5,4.2){\pnode{equation}}\GM@label{equation}{\huge$\sigma^A_{i}, \sigma^B_{i} \sim \mathrm{Uniform}(0,1)$}

\rput(11.5,2.7){\pnode{equation}}\GM@label{equation}{\huge$\theta^A_{i}\sim \mathrm{Gaussian}(\mu^A_{i}, \sigma^A_{i})$}

\rput(11.5,1.7){\pnode{equation}}\GM@label{equation}{\huge$\theta^B_{i}\sim \mathrm{Gaussian}(\mu^B_{i}, \sigma^B_{i})$}

\rput(11.5,0.2){\pnode{equation}}\GM@label{equation}{\huge$y^A_{i}\sim \mathrm{Binomial}(\theta^A_{i}, n^A)$}

\rput(11.5,-0.8){\pnode{equation}}\GM@label{equation}{\huge$y^B_{i}\sim \mathrm{Binomial}(\theta^B_{i}, n^B)$}











% 6. End document
%%%%%%%%%%%%%%%%%

\end{pspicture}
\endTeXtoEPS
\end{document}