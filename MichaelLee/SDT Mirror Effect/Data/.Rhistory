# to Uniform Priors over the Hit and False Alarm Rates
Pr_d_A[i] ~ dnorm(Pr_mud_A,Pr_sigmad_A)
Pr_c_A[i] ~ dnorm(Pr_muc_A,Pr_sigmac_A)
Pr_d_B[i] ~ dnorm(Pr_mud_B,Pr_sigmad_B)
Pr_c_B[i] ~ dnorm(Pr_muc_B,Pr_sigmac_B)
#Differences on dprime
PRIOR_Tau_H[i] <- Pr_thetah_A[i]-Pr_thetah_B[i]
PRIOR_Tau_F[i] <- Pr_thetaf_B[i]-Pr_thetaf_A[i]
}
#Hierarchical Structure
Pr_mud_A <- Pr_MuD + Pr_delta_D/2
Pr_mud_B <- Pr_MuD - Pr_delta_D/2
Pr_lambdad_A ~ dgamma(.001,.001)
Pr_lambdad_B ~ dgamma(.001,.001)
Pr_sigmad_A <- 1/sqrt(Pr_lambdad_A)
Pr_sigmad_B <- 1/sqrt(Pr_lambdad_B)
Pr_delta_D ~ dnorm(0,1)
Pr_MuD ~ dnorm(0,1)T(0,6)
Pr_muc_A <- Pr_MuC + Pr_delta_C/2
Pr_muc_B <- Pr_MuC - Pr_delta_C/2
Pr_lambdac_A ~ dgamma(.001,.001)
Pr_lambdac_B ~ dgamma(.001,.001)
Pr_sigmac_A <- 1/sqrt(Pr_lambdac_A)
Pr_sigmac_B <- 1/sqrt(Pr_lambdac_B)
Pr_delta_C ~ dnorm(0,0.7)
Pr_MuC ~ dnorm(0,0.7)}','Tau-All.bug')
######################################
######################################
# Definimos los elementos de trabajo
######################################
data <- list("fa_A", "fa_B", "h_B", "h_A", "s", "n", "k")                    #Los datos que vamos a utilizar para nuestro modelo
myinits <- list(
list(lambdad_A = 1,  lambdad_B = 1, delta_D = 0, MuD = 0,
lambdac_A = 1,  lambdac_B = 1, delta_C = 0, MuC = 0,
Pr_lambdad_A = 1,  Pr_lambdad_B = 1, Pr_delta_D = 0, Pr_MuD = 0,
Pr_lambdac_A = 1,  Pr_lambdac_B = 1, Pr_delta_C = 0, Pr_MuC = 0))
#Parámetros monitoreados
parameters <- c("d_A", "c_A", "thetah_A", "thetaf_A",
"d_B", "c_B", "thetah_B", "thetaf_B",
"Tau_H", "Tau_F",
"mud_A", "mud_B","muc_A", "muc_B",
"Pr_d_A", "Pr_c_A", "Pr_thetah_A", "Pr_thetaf_A",
"Pr_d_B", "Pr_c_B", "Pr_thetah_B", "Pr_thetaf_B",
"PRIOR_Tau_H", "PRIOR_Tau_F",
"Pr_mud_A", "Pr_mud_B","Pr_muc_A", "Pr_muc_B",
"prior_h_A", "prior_h_B", "prior_fa_A", "prior_fa_B",
"sigmad_A",  "sigmad_B", "delta_D", "MuD",
"sigmac_A",  "sigmac_B", "delta_C", "MuC",
"Pr_sigmad_A", "Pr_sigmad_B", "Pr_delta_D", "Pr_MuD",
"Pr_sigmac_A", "Pr_sigmac_B", "Pr_delta_C", "Pr_MuC")
niter <- 50000    #Iteraciones
burnin <- 5000     #No. de primeros sampleos en ignorarse
#Corremos el modelo
samples <- jags(data, inits=myinits, parameters,
model.file ="Tau-All.bug",
n.chains=1, n.iter=niter, n.burnin=burnin, n.thin=1)
####################################################################
# Jalamos los resultados de correr el modelo (Inferencias)
# a.k.a.:
#Le ponemos una etiqueta a cada elemento contenido en Samples
####################################################################
d_a <- samples$BUGSoutput$sims.list$d_A
d_b <- samples$BUGSoutput$sims.list$d_B
c_a <- samples$BUGSoutput$sims.list$c_A
c_b <- samples$BUGSoutput$sims.list$c_B
muDA <- samples$BUGSoutput$sims.list$mud_A
muDB <- samples$BUGSoutput$sims.list$mud_B
muD <- samples$BUGSoutput$sims.list$MuD
DeltaD <- samples$BUGSoutput$sims.list$delta_D
muCA <- samples$BUGSoutput$sims.list$muc_A
muCB <- samples$BUGSoutput$sims.list$muc_B
muC <- samples$BUGSoutput$sims.list$MuC
DeltaC <- samples$BUGSoutput$sims.list$delta_C
tetaH_a <- samples$BUGSoutput$sims.list$thetah_A
tetaH_b <- samples$BUGSoutput$sims.list$thetah_B
tetaFA_a <- samples$BUGSoutput$sims.list$thetaf_A
tetaFA_b <- samples$BUGSoutput$sims.list$thetaf_B
tauH <- samples$BUGSoutput$sims.list$Tau_H
tauF <- samples$BUGSoutput$sims.list$Tau_F
#Prior predictiva
Pr_d_a <- samples$BUGSoutput$sims.list$Pr_d_A
Pr_d_b <- samples$BUGSoutput$sims.list$Pr_d_B
Pr_c_a <- samples$BUGSoutput$sims.list$Pr_c_A
Pr_c_b <- samples$BUGSoutput$sims.list$Pr_c_B
Pr_muDA <- samples$BUGSoutput$sims.list$Pr_mud_A
Pr_muDB <- samples$BUGSoutput$sims.list$Pr_mud_B
Pr_muD <- samples$BUGSoutput$sims.list$Pr_MuD
Pr_Delta <- samples$BUGSoutput$sims.list$Pr_delta
Pr_muCA <- samples$BUGSoutput$sims.list$Pr_muc_A
Pr_muCB <- samples$BUGSoutput$sims.list$Pr_muc_B
Pr_muC <- samples$BUGSoutput$sims.list$Pr_MuC
Pr_Delta <- samples$BUGSoutput$sims.list$Pr_delta
Pr_Ha <- samples$BUGSoutput$sims.list$prior_h_A
Pr_Hb <- samples$BUGSoutput$sims.list$prior_h_B
Pr_Fa <- samples$BUGSoutput$sims.list$prior_fa_A
Pr_Fb <- samples$BUGSoutput$sims.list$prior_fa_B
Pr_tetaH_a <- samples$BUGSoutput$sims.list$Pr_thetah_A
Pr_tetaH_b <- samples$BUGSoutput$sims.list$Pr_thetah_B
Pr_tetaFA_a <- samples$BUGSoutput$sims.list$Pr_thetaf_A
Pr_tetaFA_b <- samples$BUGSoutput$sims.list$Pr_thetaf_B
Pr_tauH <- samples$BUGSoutput$sims.list$PRIOR_Tau_H
Pr_tauF <- samples$BUGSoutput$sims.list$PRIOR_Tau_F
Predicted_Ha <- NULL
Predicted_Hb <- NULL
Predicted_Fa <- NULL
Predicted_Fb <- NULL
for(i in 1:k){
Predicted_Ha[i] <- round(median(density(Pr_Ha[,i])$x[which(density(Pr_Ha[,i])$y==max(density(Pr_Ha[,i])$y))-rbinom(1,10,.5)]),0)
Predicted_Hb[i] <- round(median(density(Pr_Hb[,i])$x[which(density(Pr_Hb[,i])$y==max(density(Pr_Hb[,i])$y))-rbinom(1,10,.5)]),0)
Predicted_Fa[i] <- round(median(density(Pr_Fa[,i])$x[which(density(Pr_Fa[,i])$y==max(density(Pr_Fa[,i])$y))+rbinom(1,10,.5)]),0)
Predicted_Fb[i] <- round(median(density(Pr_Fb[,i])$x[which(density(Pr_Fb[,i])$y==max(density(Pr_Fb[,i])$y))+rbinom(1,10,.5)]),0)
}
setwd("C:/Users/Alejandro/Desktop/afchavez19/MichaelLee/SDT Mirror Effect/Data")
rm(list=ls())
dir()
library(R2jags)
##############################################################
##############################################################
#Diferencias en Hits y Falsas Alarmas
#Modelo 1 :  Diferencias entre las Tasas H y FA (parametros TauH y TauF)
#            contra datos generados usando las priors
##############################################################
######################################################
#Especificamos el Experimento y los Datos a analizar
experimento <- 1
###################
if (experimento == 1)    #Una Figura de Ebbinghaus
{
exp <- 1
archive <-'Ex_1Ebb_TODOS.csv'         #El archivo que contiene los datos
datos <- read.csv(archive)          #Jalamos los datos del archivo
}
if (experimento == 2)   # Dos Figuras de Ebbinghaus
{
exp <- 2
archive <-'Ex_2Ebb_TODOS_Sin1.csv'  #El archivo que contiene los datos
datos <- read.csv(archive)          #Jalamos los datos
}
h_A <- datos$A_H       #Hits(A)
h_B <- datos$B_H     #Hits(B)
fa_A <- datos$A_FA        #FA(A)
fa_B <- datos$B_FA      #FA(B)
k <- 20                       #Participantes
s <- 160       #Ensayos con Señal
n <- 160       #Ensayos con Ruido
############################################################################
############################################################################
#Escribimos el modelo Inicial
############################################################################
write('
model{
#Posterior estimations (based on the data collected)
for (i in 1:k){
# Posterior density based on our data
h_A[i] ~ dbin(thetah_A[i],s)
fa_A[i] ~ dbin(thetaf_A[i],n)
h_B[i] ~ dbin(thetah_B[i],s)
fa_B[i] ~ dbin(thetaf_B[i],n)
# Reparameterization Using Equal-Variance Gaussian SDT
thetah_A[i] <- phi(d_A[i]/2-c_A[i])
thetaf_A[i] <- phi(-d_A[i]/2-c_A[i])
thetah_B[i] <- phi(d_B[i]/2-c_B[i])
thetaf_B[i] <- phi(-d_B[i]/2-c_B[i])
# These Priors over Discriminability and Bias Correspond
# to Uniform Priors over the Hit and False Alarm Rates
d_A[i] ~ dnorm(mud_A,sigmad_A)
c_A[i] ~ dnorm(muc_A,sigmac_A)
d_B[i] ~ dnorm(mud_B,sigmad_B)
c_B[i] ~ dnorm(muc_B,sigmac_B)
Tau_H[i] <- thetah_A[i]-thetah_B[i]
Tau_F[i] <- thetaf_B[i]-thetaf_A[i]}
#Hierarchical Structure
mud_A <- MuD + delta_D/2
mud_B <- MuD - delta_D/2
lambdad_A ~ dgamma(.001,.001)
lambdad_B ~ dgamma(.001,.001)
sigmad_A <- 1/sqrt(lambdad_A)
sigmad_B <- 1/sqrt(lambdad_B)
delta_D ~ dnorm(0,1)
MuD ~ dnorm(0,1)T(0,6)
muc_A <- MuC + delta_C/2
muc_B <- MuC - delta_C/2
lambdac_A ~ dgamma(.001,.001)
lambdac_B ~ dgamma(.001,.001)
sigmac_A <- 1/sqrt(lambdac_A)
sigmac_B <- 1/sqrt(lambdac_B)
delta_C ~ dnorm(0,0.7)
MuC ~ dnorm(0,0.7)
#Plain priors for drawing prior predictions
for (i in 1:k){
prior_h_A[i] ~ dbin(Pr_thetah_A[i],s)
prior_fa_A[i] ~ dbin(Pr_thetaf_A[i],n)
prior_h_B[i] ~ dbin(Pr_thetah_B[i],s)
prior_fa_B[i] ~ dbin(Pr_thetaf_B[i],n)
# Reparameterization Using Equal-Variance Gaussian SDT
Pr_thetah_A[i] <- phi(Pr_d_A[i]/2-Pr_c_A[i])
Pr_thetaf_A[i] <- phi(-Pr_d_A[i]/2-Pr_c_A[i])
Pr_thetah_B[i] <- phi(Pr_d_B[i]/2-Pr_c_B[i])
Pr_thetaf_B[i] <- phi(-Pr_d_B[i]/2-Pr_c_B[i])
# These Priors over Discriminability and Bias Correspond
# to Uniform Priors over the Hit and False Alarm Rates
Pr_d_A[i] ~ dnorm(Pr_mud_A,Pr_sigmad_A)
Pr_c_A[i] ~ dnorm(Pr_muc_A,Pr_sigmac_A)
Pr_d_B[i] ~ dnorm(Pr_mud_B,Pr_sigmad_B)
Pr_c_B[i] ~ dnorm(Pr_muc_B,Pr_sigmac_B)
#Differences on dprime
PRIOR_Tau_H[i] <- Pr_thetah_A[i]-Pr_thetah_B[i]
PRIOR_Tau_F[i] <- Pr_thetaf_B[i]-Pr_thetaf_A[i]
}
#Hierarchical Structure
Pr_mud_A <- Pr_MuD + Pr_delta_D/2
Pr_mud_B <- Pr_MuD - Pr_delta_D/2
Pr_lambdad_A ~ dgamma(.001,.001)
Pr_lambdad_B ~ dgamma(.001,.001)
Pr_sigmad_A <- 1/sqrt(Pr_lambdad_A)
Pr_sigmad_B <- 1/sqrt(Pr_lambdad_B)
Pr_delta_D ~ dnorm(0,1)
Pr_MuD ~ dnorm(0,1)T(0,6)
Pr_muc_A <- Pr_MuC + Pr_delta_C/2
Pr_muc_B <- Pr_MuC - Pr_delta_C/2
Pr_lambdac_A ~ dgamma(.001,.001)
Pr_lambdac_B ~ dgamma(.001,.001)
Pr_sigmac_A <- 1/sqrt(Pr_lambdac_A)
Pr_sigmac_B <- 1/sqrt(Pr_lambdac_B)
Pr_delta_C ~ dnorm(0,0.7)
Pr_MuC ~ dnorm(0,0.7)}','Tau-All.bug')
######################################
######################################
# Definimos los elementos de trabajo
######################################
data <- list("fa_A", "fa_B", "h_B", "h_A", "s", "n", "k")                    #Los datos que vamos a utilizar para nuestro modelo
myinits <- list(
list(lambdad_A = 0,  lambdad_B = 1, delta_D = 0, MuD = 0,
lambdac_A = 0,  lambdac_B = 1, delta_C = 0, MuC = 0,
Pr_lambdad_A = 0,  Pr_lambdad_B = 0, Pr_delta_D = 0, Pr_MuD = 0,
Pr_lambdac_A = 0,  Pr_lambdac_B = 0, Pr_delta_C = 0, Pr_MuC = 0))
#Parámetros monitoreados
parameters <- c("d_A", "c_A", "thetah_A", "thetaf_A",
"d_B", "c_B", "thetah_B", "thetaf_B",
"Tau_H", "Tau_F",
"mud_A", "mud_B","muc_A", "muc_B",
"Pr_d_A", "Pr_c_A", "Pr_thetah_A", "Pr_thetaf_A",
"Pr_d_B", "Pr_c_B", "Pr_thetah_B", "Pr_thetaf_B",
"PRIOR_Tau_H", "PRIOR_Tau_F",
"Pr_mud_A", "Pr_mud_B","Pr_muc_A", "Pr_muc_B",
"prior_h_A", "prior_h_B", "prior_fa_A", "prior_fa_B",
"sigmad_A",  "sigmad_B", "delta_D", "MuD",
"sigmac_A",  "sigmac_B", "delta_C", "MuC",
"Pr_sigmad_A", "Pr_sigmad_B", "Pr_delta_D", "Pr_MuD",
"Pr_sigmac_A", "Pr_sigmac_B", "Pr_delta_C", "Pr_MuC")
niter <- 50000    #Iteraciones
burnin <- 5000     #No. de primeros sampleos en ignorarse
#Corremos el modelo
samples <- jags(data, inits=myinits, parameters,
model.file ="Tau-All.bug",
n.chains=1, n.iter=niter, n.burnin=burnin, n.thin=1)
####################################################################
# Jalamos los resultados de correr el modelo (Inferencias)
# a.k.a.:
#Le ponemos una etiqueta a cada elemento contenido en Samples
####################################################################
d_a <- samples$BUGSoutput$sims.list$d_A
d_b <- samples$BUGSoutput$sims.list$d_B
c_a <- samples$BUGSoutput$sims.list$c_A
c_b <- samples$BUGSoutput$sims.list$c_B
muDA <- samples$BUGSoutput$sims.list$mud_A
muDB <- samples$BUGSoutput$sims.list$mud_B
muD <- samples$BUGSoutput$sims.list$MuD
DeltaD <- samples$BUGSoutput$sims.list$delta_D
muCA <- samples$BUGSoutput$sims.list$muc_A
muCB <- samples$BUGSoutput$sims.list$muc_B
muC <- samples$BUGSoutput$sims.list$MuC
DeltaC <- samples$BUGSoutput$sims.list$delta_C
tetaH_a <- samples$BUGSoutput$sims.list$thetah_A
tetaH_b <- samples$BUGSoutput$sims.list$thetah_B
tetaFA_a <- samples$BUGSoutput$sims.list$thetaf_A
tetaFA_b <- samples$BUGSoutput$sims.list$thetaf_B
tauH <- samples$BUGSoutput$sims.list$Tau_H
tauF <- samples$BUGSoutput$sims.list$Tau_F
#Prior predictiva
Pr_d_a <- samples$BUGSoutput$sims.list$Pr_d_A
Pr_d_b <- samples$BUGSoutput$sims.list$Pr_d_B
Pr_c_a <- samples$BUGSoutput$sims.list$Pr_c_A
Pr_c_b <- samples$BUGSoutput$sims.list$Pr_c_B
Pr_muDA <- samples$BUGSoutput$sims.list$Pr_mud_A
Pr_muDB <- samples$BUGSoutput$sims.list$Pr_mud_B
Pr_muD <- samples$BUGSoutput$sims.list$Pr_MuD
Pr_Delta <- samples$BUGSoutput$sims.list$Pr_delta
Pr_muCA <- samples$BUGSoutput$sims.list$Pr_muc_A
Pr_muCB <- samples$BUGSoutput$sims.list$Pr_muc_B
Pr_muC <- samples$BUGSoutput$sims.list$Pr_MuC
Pr_Delta <- samples$BUGSoutput$sims.list$Pr_delta
Pr_Ha <- samples$BUGSoutput$sims.list$prior_h_A
Pr_Hb <- samples$BUGSoutput$sims.list$prior_h_B
Pr_Fa <- samples$BUGSoutput$sims.list$prior_fa_A
Pr_Fb <- samples$BUGSoutput$sims.list$prior_fa_B
Pr_tetaH_a <- samples$BUGSoutput$sims.list$Pr_thetah_A
Pr_tetaH_b <- samples$BUGSoutput$sims.list$Pr_thetah_B
Pr_tetaFA_a <- samples$BUGSoutput$sims.list$Pr_thetaf_A
Pr_tetaFA_b <- samples$BUGSoutput$sims.list$Pr_thetaf_B
Pr_tauH <- samples$BUGSoutput$sims.list$PRIOR_Tau_H
Pr_tauF <- samples$BUGSoutput$sims.list$PRIOR_Tau_F
Predicted_Ha <- NULL
Predicted_Hb <- NULL
Predicted_Fa <- NULL
Predicted_Fb <- NULL
for(i in 1:k){
Predicted_Ha[i] <- round(median(density(Pr_Ha[,i])$x[which(density(Pr_Ha[,i])$y==max(density(Pr_Ha[,i])$y))-rbinom(1,10,.5)]),0)
Predicted_Hb[i] <- round(median(density(Pr_Hb[,i])$x[which(density(Pr_Hb[,i])$y==max(density(Pr_Hb[,i])$y))-rbinom(1,10,.5)]),0)
Predicted_Fa[i] <- round(median(density(Pr_Fa[,i])$x[which(density(Pr_Fa[,i])$y==max(density(Pr_Fa[,i])$y))+rbinom(1,10,.5)]),0)
Predicted_Fb[i] <- round(median(density(Pr_Fb[,i])$x[which(density(Pr_Fb[,i])$y==max(density(Pr_Fb[,i])$y))+rbinom(1,10,.5)]),0)
}
setwd("C:/Users/Alejandro/Desktop/afchavez19/MichaelLee/SDT Mirror Effect/Data")
rm(list=ls())
dir()
library(R2jags)
##############################################################
##############################################################
#Diferencias en Hits y Falsas Alarmas
#Modelo 1 :  Diferencias entre las Tasas H y FA (parametros TauH y TauF)
#            contra datos generados usando las priors
##############################################################
######################################################
#Especificamos el Experimento y los Datos a analizar
experimento <- 1
###################
if (experimento == 1)    #Una Figura de Ebbinghaus
{
exp <- 1
archive <-'Ex_1Ebb_TODOS.csv'         #El archivo que contiene los datos
datos <- read.csv(archive)          #Jalamos los datos del archivo
}
if (experimento == 2)   # Dos Figuras de Ebbinghaus
{
exp <- 2
archive <-'Ex_2Ebb_TODOS_Sin1.csv'  #El archivo que contiene los datos
datos <- read.csv(archive)          #Jalamos los datos
}
h_A <- datos$A_H       #Hits(A)
h_B <- datos$B_H     #Hits(B)
fa_A <- datos$A_FA        #FA(A)
fa_B <- datos$B_FA      #FA(B)
k <- 20                       #Participantes
s <- 160       #Ensayos con Señal
n <- 160       #Ensayos con Ruido
############################################################################
############################################################################
#Escribimos el modelo Inicial
############################################################################
write('
model{
#Posterior estimations (based on the data collected)
for (i in 1:k){
# Posterior density based on our data
h_A[i] ~ dbin(thetah_A[i],s)
fa_A[i] ~ dbin(thetaf_A[i],n)
h_B[i] ~ dbin(thetah_B[i],s)
fa_B[i] ~ dbin(thetaf_B[i],n)
# Reparameterization Using Equal-Variance Gaussian SDT
thetah_A[i] <- phi(d_A[i]/2-c_A[i])
thetaf_A[i] <- phi(-d_A[i]/2-c_A[i])
thetah_B[i] <- phi(d_B[i]/2-c_B[i])
thetaf_B[i] <- phi(-d_B[i]/2-c_B[i])
# These Priors over Discriminability and Bias Correspond
# to Uniform Priors over the Hit and False Alarm Rates
d_A[i] ~ dnorm(mud_A,sigmad_A)
c_A[i] ~ dnorm(muc_A,sigmac_A)
d_B[i] ~ dnorm(mud_B,sigmad_B)
c_B[i] ~ dnorm(muc_B,sigmac_B)
Tau_H[i] <- thetah_A[i]-thetah_B[i]
Tau_F[i] <- thetaf_B[i]-thetaf_A[i]}
#Hierarchical Structure
mud_A <- MuD + delta_D/2
mud_B <- MuD - delta_D/2
lambdad_A ~ dgamma(.001,.001)
lambdad_B ~ dgamma(.001,.001)
sigmad_A <- 1/sqrt(lambdad_A)
sigmad_B <- 1/sqrt(lambdad_B)
delta_D ~ dnorm(0,1)
MuD ~ dnorm(0,1)T(0,6)
muc_A <- MuC + delta_C/2
muc_B <- MuC - delta_C/2
lambdac_A ~ dgamma(.001,.001)
lambdac_B ~ dgamma(.001,.001)
sigmac_A <- 1/sqrt(lambdac_A)
sigmac_B <- 1/sqrt(lambdac_B)
delta_C ~ dnorm(0,0.7)
MuC ~ dnorm(0,0.7)
#Plain priors for drawing prior predictions
for (i in 1:k){
prior_h_A[i] ~ dbin(Pr_thetah_A[i],s)
prior_fa_A[i] ~ dbin(Pr_thetaf_A[i],n)
prior_h_B[i] ~ dbin(Pr_thetah_B[i],s)
prior_fa_B[i] ~ dbin(Pr_thetaf_B[i],n)
# Reparameterization Using Equal-Variance Gaussian SDT
Pr_thetah_A[i] <- phi(Pr_d_A[i]/2-Pr_c_A[i])
Pr_thetaf_A[i] <- phi(-Pr_d_A[i]/2-Pr_c_A[i])
Pr_thetah_B[i] <- phi(Pr_d_B[i]/2-Pr_c_B[i])
Pr_thetaf_B[i] <- phi(-Pr_d_B[i]/2-Pr_c_B[i])
# These Priors over Discriminability and Bias Correspond
# to Uniform Priors over the Hit and False Alarm Rates
Pr_d_A[i] ~ dnorm(Pr_mud_A,Pr_sigmad_A)
Pr_c_A[i] ~ dnorm(Pr_muc_A,Pr_sigmac_A)
Pr_d_B[i] ~ dnorm(Pr_mud_B,Pr_sigmad_B)
Pr_c_B[i] ~ dnorm(Pr_muc_B,Pr_sigmac_B)
#Differences on dprime
PRIOR_Tau_H[i] <- Pr_thetah_A[i]-Pr_thetah_B[i]
PRIOR_Tau_F[i] <- Pr_thetaf_B[i]-Pr_thetaf_A[i]
}
#Hierarchical Structure
Pr_mud_A <- Pr_MuD + Pr_delta_D/2
Pr_mud_B <- Pr_MuD - Pr_delta_D/2
Pr_lambdad_A ~ dgamma(.001,.001)
Pr_lambdad_B ~ dgamma(.001,.001)
Pr_sigmad_A <- 1/sqrt(Pr_lambdad_A)
Pr_sigmad_B <- 1/sqrt(Pr_lambdad_B)
Pr_delta_D ~ dnorm(0,1)
Pr_MuD ~ dnorm(0,1)T(0,6)
Pr_muc_A <- Pr_MuC + Pr_delta_C/2
Pr_muc_B <- Pr_MuC - Pr_delta_C/2
Pr_lambdac_A ~ dgamma(.001,.001)
Pr_lambdac_B ~ dgamma(.001,.001)
Pr_sigmac_A <- 1/sqrt(Pr_lambdac_A)
Pr_sigmac_B <- 1/sqrt(Pr_lambdac_B)
Pr_delta_C ~ dnorm(0,0.7)
Pr_MuC ~ dnorm(0,0.7)}','Tau-All.bug')
######################################
######################################
# Definimos los elementos de trabajo
######################################
data <- list("fa_A", "fa_B", "h_B", "h_A", "s", "n", "k")                    #Los datos que vamos a utilizar para nuestro modelo
myinits <- list(
list(lambdad_A = 0,  lambdad_B = 0, delta_D = 0, MuD = 0,
lambdac_A = 0,  lambdac_B = 0, delta_C = 0, MuC = 0,
Pr_lambdad_A = 0,  Pr_lambdad_B = 0, Pr_delta_D = 0, Pr_MuD = 0,
Pr_lambdac_A = 0,  Pr_lambdac_B = 0, Pr_delta_C = 0, Pr_MuC = 0))
#Parámetros monitoreados
parameters <- c("d_A", "c_A", "thetah_A", "thetaf_A",
"d_B", "c_B", "thetah_B", "thetaf_B",
"Tau_H", "Tau_F",
"mud_A", "mud_B","muc_A", "muc_B",
"Pr_d_A", "Pr_c_A", "Pr_thetah_A", "Pr_thetaf_A",
"Pr_d_B", "Pr_c_B", "Pr_thetah_B", "Pr_thetaf_B",
"PRIOR_Tau_H", "PRIOR_Tau_F",
"Pr_mud_A", "Pr_mud_B","Pr_muc_A", "Pr_muc_B",
"prior_h_A", "prior_h_B", "prior_fa_A", "prior_fa_B",
"sigmad_A",  "sigmad_B", "delta_D", "MuD",
"sigmac_A",  "sigmac_B", "delta_C", "MuC",
"Pr_sigmad_A", "Pr_sigmad_B", "Pr_delta_D", "Pr_MuD",
"Pr_sigmac_A", "Pr_sigmac_B", "Pr_delta_C", "Pr_MuC")
niter <- 50000    #Iteraciones
burnin <- 5000     #No. de primeros sampleos en ignorarse
#Corremos el modelo
samples <- jags(data, inits=myinits, parameters,
model.file ="Tau-All.bug",
n.chains=1, n.iter=niter, n.burnin=burnin, n.thin=1)
####################################################################
# Jalamos los resultados de correr el modelo (Inferencias)
# a.k.a.:
#Le ponemos una etiqueta a cada elemento contenido en Samples
####################################################################
d_a <- samples$BUGSoutput$sims.list$d_A
d_b <- samples$BUGSoutput$sims.list$d_B
c_a <- samples$BUGSoutput$sims.list$c_A
c_b <- samples$BUGSoutput$sims.list$c_B
muDA <- samples$BUGSoutput$sims.list$mud_A
muDB <- samples$BUGSoutput$sims.list$mud_B
muD <- samples$BUGSoutput$sims.list$MuD
DeltaD <- samples$BUGSoutput$sims.list$delta_D
muCA <- samples$BUGSoutput$sims.list$muc_A
muCB <- samples$BUGSoutput$sims.list$muc_B
muC <- samples$BUGSoutput$sims.list$MuC
DeltaC <- samples$BUGSoutput$sims.list$delta_C
tetaH_a <- samples$BUGSoutput$sims.list$thetah_A
tetaH_b <- samples$BUGSoutput$sims.list$thetah_B
tetaFA_a <- samples$BUGSoutput$sims.list$thetaf_A
tetaFA_b <- samples$BUGSoutput$sims.list$thetaf_B
tauH <- samples$BUGSoutput$sims.list$Tau_H
tauF <- samples$BUGSoutput$sims.list$Tau_F
#Prior predictiva
Pr_d_a <- samples$BUGSoutput$sims.list$Pr_d_A
Pr_d_b <- samples$BUGSoutput$sims.list$Pr_d_B
Pr_c_a <- samples$BUGSoutput$sims.list$Pr_c_A
Pr_c_b <- samples$BUGSoutput$sims.list$Pr_c_B
Pr_muDA <- samples$BUGSoutput$sims.list$Pr_mud_A
Pr_muDB <- samples$BUGSoutput$sims.list$Pr_mud_B
Pr_muD <- samples$BUGSoutput$sims.list$Pr_MuD
Pr_Delta <- samples$BUGSoutput$sims.list$Pr_delta
Pr_muCA <- samples$BUGSoutput$sims.list$Pr_muc_A
Pr_muCB <- samples$BUGSoutput$sims.list$Pr_muc_B
Pr_muC <- samples$BUGSoutput$sims.list$Pr_MuC
Pr_Delta <- samples$BUGSoutput$sims.list$Pr_delta
Pr_Ha <- samples$BUGSoutput$sims.list$prior_h_A
Pr_Hb <- samples$BUGSoutput$sims.list$prior_h_B
Pr_Fa <- samples$BUGSoutput$sims.list$prior_fa_A
Pr_Fb <- samples$BUGSoutput$sims.list$prior_fa_B
Pr_tetaH_a <- samples$BUGSoutput$sims.list$Pr_thetah_A
Pr_tetaH_b <- samples$BUGSoutput$sims.list$Pr_thetah_B
Pr_tetaFA_a <- samples$BUGSoutput$sims.list$Pr_thetaf_A
Pr_tetaFA_b <- samples$BUGSoutput$sims.list$Pr_thetaf_B
Pr_tauH <- samples$BUGSoutput$sims.list$PRIOR_Tau_H
Pr_tauF <- samples$BUGSoutput$sims.list$PRIOR_Tau_F
Predicted_Ha <- NULL
Predicted_Hb <- NULL
Predicted_Fa <- NULL
Predicted_Fb <- NULL
for(i in 1:k){
Predicted_Ha[i] <- round(median(density(Pr_Ha[,i])$x[which(density(Pr_Ha[,i])$y==max(density(Pr_Ha[,i])$y))-rbinom(1,10,.5)]),0)
Predicted_Hb[i] <- round(median(density(Pr_Hb[,i])$x[which(density(Pr_Hb[,i])$y==max(density(Pr_Hb[,i])$y))-rbinom(1,10,.5)]),0)
Predicted_Fa[i] <- round(median(density(Pr_Fa[,i])$x[which(density(Pr_Fa[,i])$y==max(density(Pr_Fa[,i])$y))+rbinom(1,10,.5)]),0)
Predicted_Fb[i] <- round(median(density(Pr_Fb[,i])$x[which(density(Pr_Fb[,i])$y==max(density(Pr_Fb[,i])$y))+rbinom(1,10,.5)]),0)
}
