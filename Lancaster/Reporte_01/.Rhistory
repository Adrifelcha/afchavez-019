c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.14,0.14),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.285,.285),lwd=2,lty=3, col="black"),lines(c(0,1),c(.43,.43),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.71,.71),lwd=2,lty=3, col="black"),lines(c(0,1),c(.57,.57),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.855,.855),lwd=2,lty=3, col="black")))
axis(2,at=seq(0,7,1),labels=seq(0,7,1),las=1, line=-1.5)
mtext(side=3, text = "Porcentaje de estudiantes que acertaron cada item", line=0.5, cex=1.2, f=2)
mtext(side=3, text = paste("Dificultad de los ítems para", g,"año"), line=1.5, cex=2, f=2)
mtext(side=2, text = "Frecuencia (No. de items)", line=0.5, cex=1.2, f=2)
axis(1,at=seq(0.025,1,0.05),labels=c("0 a 5%","6 a 10%","11 a 15%","16 a 20%","21 a 25%","26 a 30%","31 a 35%","36 a 40%","41 a 45%","46 a 50%","51 a 55%","56 a 60%","61 a 65%","66 a 70%","71 a 75%","76 a 80%","81 a 85%","86 a 90%","91 a 95%","96 a 100%"), line=-0.5, f=2,las=2)
print(g)
print(which(P<.3))
print(P[40])
print(P[48])
print(P[27])
print(P[31])
#Aciertos por item
Unos <- NULL
for(i in 1:length(Items)){
Unos[i] <- sum(Dicot[(Datos$GRADO==g)==TRUE,i+7], na.rm = TRUE)
}
valor_label_u <- 1.2
valor_label_r <- 1.2
barplot(Unos, col="gray96", ann=F, axes=F, ylim=c(0,120))
axis(2,at=seq(0,120,6),labels=seq(0,120,6),las=1, line=-1.5)
text(32.5, 115, "Forma 2", f=2, col="lightgoldenrod4")
text(27.5, 115, "Forma 1", f=2, col="lightgoldenrod3")
lines(c(30.1,30.1),c(0,120),col='black', lty=1,lwd=1.3)
lines(c(30.1,60),c(120,120),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(120,120),lty=1,lwd=4, col="lightgoldenrod1")
mtext(side=3, text = paste("Tomando en cuenta a los estudiantes de", g, "y comparándolos con la muestra total"), line=0.5, cex=0.8, f=2)
mtext(side=3, text = "Número de estudiantes que acertaron cada item", line=1.5, cex=2, f=2)
mtext(side=1, text = "Item ID", line=2.5, cex=1.2, f=2)
axis(1,at=seq(.7,59.7,1.2),labels=seq(1,50,1), line=0, f=2,las=2)
for(i in 1:length(Unos)){
if(i==1){
text(0.7, Unos[i]+0, paste(Unos[i]), cex=1.1, f=2)
}else{
text(0.7+valor_label_u, Unos[i]+5, paste(Unos[i]), cex=1.1, f=2)
valor_label_u <- valor_label_u+1.2
}}
for(i in 1:length(Rights)){
if(i==1){
text(0.7, Rights[i]+0, paste(Rights[i]), cex=0.7, f=2, col="gray60")
lines(c(0.7,0.7),c(0,Rights[i]), col="gray87", lwd=2,lty=4)
}else{
text(0.7+valor_label_r, Rights[i]+5, paste(Rights[i]), cex=0.7, f=2, col="gray60")
lines(c(0.7+valor_label_r,0.7+valor_label_r),c(0,Rights[i]), col="gray87", lwd=2,lty=4)
valor_label_r <- valor_label_r+1.2}}
PUnos <- NULL
for(i in 1:length(Items)){
PUnos[i] <- (((Unos[i])/length(Score_FA[Datos$GRADO==g]))*100)
}
valor_label <- 1.2
barplot(PUnos, col="gray96", ann=F, axes=F, ylim=c(0,100))
axis(2,at=seq(0,100,10),labels=paste(seq(0,100,10),"%"),las=1, line=-1.5)
text(32.5, 115, "Forma 2", f=2, col="lightgoldenrod4")
text(27.5, 115, "Forma 1", f=2, col="lightgoldenrod3")
lines(c(30.1,30.1),c(0,120),col='black', lty=1,lwd=1.3)
lines(c(30.1,60),c(120,120),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(120,120),lty=1,lwd=4, col="lightgoldenrod1")
mtext(side=3, text = paste("Tomando en cuenta a los estudiantes de",g), line=0.5, cex=0.8, f=2)
mtext(side=3, text = "Porcentaje de estudiantes que acertaron cada item", line=1.5, cex=2, f=2)
mtext(side=1, text = "Item ID", line=2.5, cex=1.2, f=2)
axis(1,at=seq(.7,59.7,1.2),labels=seq(1,50,1), line=0, f=2,las=2)
for(i in 1:length(PRights)){
if(i==1){
text(0.7, PUnos[i]+6.5, paste(round(PUnos[i],2),"%"), cex=1.1, f=2, srt=90)
}else{
text(0.7+valor_label, PUnos[i]+6.5, paste(round(PUnos[i],2),"%"), cex=1.1, f=2, srt=90)
valor_label <- valor_label+1.2
}}
}
######################################################################
######################################################################
# Se segrega el análisis por GRADO
colores <- c("cadetblue2", "dodgerblue3")
col_dif <- c("cadetblue3", "dodgerblue4")
mean_A <- c(16.09836, 16.69355)
mean_B <- c(8.951613, 11.22623)
mean_T <- c(25.96667, 28.2)
w <- 0
for(g in sort(unique(Datos$GRADO))){
w <- w+1
valor_label <- NULL
hist(Score_FA[Datos$GRADO==g], breaks=seq(-.1,25,by=1), ann=F, axes=F, xlim=c(0,25), col= colores[w],
ylim=c(0,11),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.09,0.09),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.18,.18),lwd=2,lty=3, col="black"),lines(c(0,1),c(.27,.27),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.36,.36),lwd=2,lty=3, col="black"),lines(c(0,1),c(.45,.45),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.545,.545),lwd=2,lty=3, col="black"),lines(c(0,1),c(.635,.635),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.725,.725),lwd=2,lty=3, col="black"),lines(c(0,1),c(.82,.82),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.91,.91),lwd=2,lty=3, col="black")))
lines(c(0.9,0.9),c(0,11),col='black', lty=4,lwd=2)
text(9,10.3, paste("Respondieron la Forma A:"), f=2, cex=1.2)
text(9,9.8, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,10])==FALSE)), " estudiantes de",g, "año" ), f=2)
text(0.5,6, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,10])==TRUE)), " estudiante(s) no asistieron"), srt=90, f=2)
text(4,7.4, paste("Promedio: ",round(mean_A[w],2)), f=2)
text(4,6.3, paste("Máxima: ",round(max(Score_FA[Datos$GRADO==g]),2)), f=2)
text(4,5.9, paste("Mínima: ",round(min(Score_FA[Datos$GRADO==g]),2)), f=2)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = paste("Puntuación - Forma A"), line=1.5, cex=2, f=2)
mtext(side=3, text = paste("(",g,"año)"), line=0.2, cex=1.2, f=2)
axis(2,at=seq(0,11,1),labels=seq(0,11,1),las=1, line=-1.1)
axis(1,at=c(0.4:50.4),labels=c(0:50), line=-0.5, f=2)
hist(Score_FB[Datos$GRADO==g], breaks=seq(-0.1,25,by=1), ann=F, axes=F, xlim=c(0,25), col= colores[w],
ylim=c(0,11),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.09,0.09),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.18,.18),lwd=2,lty=3, col="black"),lines(c(0,1),c(.27,.27),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.36,.36),lwd=2,lty=3, col="black"),lines(c(0,1),c(.45,.45),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.545,.545),lwd=2,lty=3, col="black"),lines(c(0,1),c(.635,.635),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.725,.725),lwd=2,lty=3, col="black"),lines(c(0,1),c(.82,.82),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.91,.91),lwd=2,lty=3, col="black")))
lines(c(0.9,0.9),c(0,11),col='black', lty=4,lwd=2)
text(11,10.3, paste("Respondieron la Forma B:"), f=2, cex=1.2)
text(11,9.8, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,40])==FALSE)), " estudiantes de ",g ), f=2)
text(0.5,6, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,40])==TRUE)), " estudiante(s) no asistieron"), srt=90, f=2)
text(19,7.3, paste("Promedio: ",round(mean_B[w],2)), f=2)
text(19,6.3, paste("Máxima: ",round(max(Score_FB[Datos$GRADO==g]),2)), f=2)
text(19,5.9, paste("Mínima: ",round(min(Score_FB[Datos$GRADO==g]),2)), f=2)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = paste("Puntuación - Forma B"), line=1.5, cex=2, f=2)
mtext(side=3, text = paste("(",g,"año)"), line=0.2, cex=1.2, f=2)
axis(2,at=seq(0,11,1),labels=seq(0,11,1),las=1, line=-1.1)
axis(1,at=c(0.4:50.4),labels=c(0:50), line=-0.5, f=2)
Second_FB <- Score_FB+26
valor_label <- NULL
hist(c(Score_FA[Datos$GRADO==g],Second_FB[Datos$GRADO==g]),ann=F, breaks=seq(-0.1,50,1), axes=F, xlim=c(0,50), col="lightgoldenrod4", ylim=c(0,11),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.0909,0.0909),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.1818,.1818),lwd=2,lty=3, col="black"),lines(c(0,1),c(.2727,.2727),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.3636,.3636),lwd=2,lty=3, col="black"),lines(c(0,1),c(.4545,.4545),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.5454,.5454),lwd=2,lty=3, col="black"),lines(c(0,1),c(.6363,.6363),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.7272,.7272),lwd=2,lty=3, col="black"),lines(c(0,1),c(.8181,.8181),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.909,.909),lwd=2,lty=3, col="black")))
lines(c(0.9,0.9),c(0,16),col='black', lty=4,lwd=2)
text(45.5, 15, "Forma 2", f=2, col="lightgoldenrod4", cex=2)
text(5.5, 15, "Forma 1", f=2, col="lightgoldenrod3", cex=2)
lines(c(25.9,25.9),c(0,16),col='black', lty=1,lwd=3)
lines(c(26.9,26.9),c(0,16),col='black', lty=4,lwd=2)
text(26.3,10, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,40])==TRUE)), " estudiante(s) no asistieron"), srt=90, f=2)
lines(c(30.1,60),c(120,120),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(120,120),lty=1,lwd=4, col="lightgoldenrod1")
text(6.5,8.8, paste("Respondieron la Forma A:"), f=2)
text(6,8.3, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,15])==FALSE)), " estudiantes de ",g ), f=2)
text(6,6.8, paste("Promedio: ",round(mean_B[w],2)), f=2)
text(46,8.8, paste("Respondieron la Forma B:"), f=2)
text(46,8.3, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,40])==FALSE)), " estudiantes de ",g ), f=2)
text(0.3,10, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,15])==TRUE)), " estudiante(s) no asistieron"), srt=90, f=2)
text(46,6.8, paste("Promedio: ",round(mean_B[w],2)), f=2)
mtext(side=1, text = "Puntuaciones", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = "Puntuaciones - Formas A y B", line=1.5, cex=2, f=2)
mtext(side=3, text = paste("(",g,"año)"), line=0.2, cex=1.2, f=2)
axis(2,at=seq(0,11,1),labels=seq(0,11,1),las=1, line=-1.2)
axis(1,at=seq(0.4,51.4,1),labels=c(c(0:25),c(0:25)), line=-0.5, f=2)
Completo <- 0
Total_Completo <- NULL
Falta_FA <- is.na(Dicot[(Datos$GRADO==g)==TRUE,10])
Falta_FB <- is.na(Dicot[(Datos$GRADO==g)==TRUE,40])
FA <- Score_FA[Datos$GRADO==g]
FB <- Score_FB[Datos$GRADO==g]
for(a in 1:length(Sujetos[Datos$GRADO==g])){
if(Falta_FA[a]==TRUE){
nada <- "nada"}else{
if(Falta_FB[a]==FALSE){
Completo <- Completo + 1
Total_Completo[Completo] <- FA[a]+FB[a]
}else{
nada <- "nada"
}}}
hist(Total_Completo, breaks=seq(0,50,by=1), ann=F, axes=F, xlim=c(0,50), col= colores[w],
ylim=c(0,6),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.165,0.165),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.33,.33),lwd=2,lty=3, col="black"),lines(c(0,1),c(.498,.498),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.665,.665),lwd=2,lty=3, col="black"),lines(c(0,1),c(.83,.83),lwd=2,lty=3, col="black")))
text(40,5.8, paste(Completo, "de", length(FA),"estudiantes"), f=2,cex=1.3)
text(40,5.5, paste("respondieron todo el examen"), f=2, cex=1.3)
text(9,4.5, paste("Promedio: ",round(mean_T[w],2)), f=2,cex=1.1)
text(9,3.8, paste("Máxima: ",max(Total_Completo)), f=2, cex=1.1)
text(9,3.5, paste("Mínima: ",min(Total_Completo)), f=2, cex=1.1)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = paste("Puntuaciones Totales en",g, "año"), line=1.5, cex=2, f=2)
mtext(side=3, text = "(Contando sólo los estudiantes que hicieron ambas formas)", line=0.5, cex=, f=2)
axis(2,at=seq(0,6,1),labels=seq(0,6,1),las=1, line=-1.1)
axis(1,at=c(0.5:50.5),labels=c(1:51), line=-0.5, f=2)
hist(Total_Completo, breaks=seq(0,50,by=5), ann=F, axes=F, xlim=c(0,50), col= colores[w],
ylim=c(0,15),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.065,0.065),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.132,.132),lwd=2,lty=3, col="black"),lines(c(0,1),c(.195,.195),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.262,.262),lwd=2,lty=3, col="black"),lines(c(0,1),c(.33,.33),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.4,.4),lwd=2,lty=3, col="black"),lines(c(0,1),c(.465,.465),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.532,.532),lwd=2,lty=3, col="black"),lines(c(0,1),c(.595,.595),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.662,.662),lwd=2,lty=3, col="black"),lines(c(0,1),c(.73,.73),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.865,.865),lwd=2,lty=3, col="black"),lines(c(0,1),c(.932,.932),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.8,.8),lwd=2,lty=3, col="black")))
text(40,14.4, paste(Completo, "de", length(FA),"estudiantes"), f=2,cex=1.3)
text(40,13.4, paste("respondieron todo el examen"), f=2, cex=1.3)
text(9,10.3, paste("Promedio: ",round(mean_T[w],2)), f=2,cex=1.1)
text(9,8.4, paste("Máxima: ",max(Total_Completo)), f=2, cex=1.1)
text(9,7.7, paste("Mínima: ",min(Total_Completo)), f=2, cex=1.1)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = paste("Puntuación TOTAL -",g, "año"), line=1.5, cex=2, f=2)
mtext(side=3, text = "(Contando sólo los estudiantes que hicieron ambas formas)", line=0.5, cex=, f=2)
axis(2,at=seq(0,15,1),labels=seq(0,15,1),las=1, line=-1.1)
axis(1,at=seq(2.5,50,5),labels=c("0-5","5-10","11-15","16-20","21-25","26-30","31-35","36-40","41-45","46-50"), line=-0.5, f=2)
P <- NULL
for(i in 1:length(Items)){
P[i] <- mean(Dicot[(Datos$GRADO==g)==TRUE,i+7],na.rm = TRUE)
}
hist(P,breaks = seq(-0.001,1,0.05), col=col_dif[w], main="Indices de dificultad generales registrados",
xlab="", ann=F, axes=F, ylim=c(0,7),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.14,0.14),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.285,.285),lwd=2,lty=3, col="black"),lines(c(0,1),c(.43,.43),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.71,.71),lwd=2,lty=3, col="black"),lines(c(0,1),c(.57,.57),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.855,.855),lwd=2,lty=3, col="black")))
axis(2,at=seq(0,7,1),labels=seq(0,7,1),las=1, line=-1.5)
mtext(side=3, text = "Porcentaje de estudiantes que acertaron cada item", line=0.5, cex=1.2, f=2)
mtext(side=3, text = paste("Dificultad de los ítems para", g,"año"), line=1.5, cex=2, f=2)
mtext(side=2, text = "Frecuencia (No. de items)", line=0.5, cex=1.2, f=2)
axis(1,at=seq(0.025,1,0.05),labels=c("0 a 5%","6 a 10%","11 a 15%","16 a 20%","21 a 25%","26 a 30%","31 a 35%","36 a 40%","41 a 45%","46 a 50%","51 a 55%","56 a 60%","61 a 65%","66 a 70%","71 a 75%","76 a 80%","81 a 85%","86 a 90%","91 a 95%","96 a 100%"), line=-0.5, f=2,las=2)
print(g)
print(which(P<.3))
print(P[40])
print(P[48])
print(P[27])
print(P[31])
#Aciertos por item
Unos <- NULL
for(i in 1:length(Items)){
Unos[i] <- sum(Dicot[(Datos$GRADO==g)==TRUE,i+7], na.rm = TRUE)
}
valor_label_u <- 1.2
valor_label_r <- 1.2
barplot(Unos, col="gray96", ann=F, axes=F, ylim=c(0,120))
axis(2,at=seq(0,120,6),labels=seq(0,120,6),las=1, line=-1.5)
text(32.5, 115, "Forma 2", f=2, col="lightgoldenrod4")
text(27.5, 115, "Forma 1", f=2, col="lightgoldenrod3")
lines(c(30.1,30.1),c(0,120),col='black', lty=1,lwd=1.3)
lines(c(30.1,60),c(120,120),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(120,120),lty=1,lwd=4, col="lightgoldenrod1")
mtext(side=3, text = paste("Tomando en cuenta a los estudiantes de", g, "y comparándolos con la muestra total"), line=0.5, cex=0.8, f=2)
mtext(side=3, text = "Número de estudiantes que acertaron cada item", line=1.5, cex=2, f=2)
mtext(side=1, text = "Item ID", line=2.5, cex=1.2, f=2)
axis(1,at=seq(.7,59.7,1.2),labels=seq(1,50,1), line=0, f=2,las=2)
for(i in 1:length(Unos)){
if(i==1){
text(0.7, Unos[i]+0, paste(Unos[i]), cex=1.1, f=2)
}else{
text(0.7+valor_label_u, Unos[i]+5, paste(Unos[i]), cex=1.1, f=2)
valor_label_u <- valor_label_u+1.2
}}
for(i in 1:length(Rights)){
if(i==1){
text(0.7, Rights[i]+0, paste(Rights[i]), cex=0.7, f=2, col="gray60")
lines(c(0.7,0.7),c(0,Rights[i]), col="gray87", lwd=2,lty=4)
}else{
text(0.7+valor_label_r, Rights[i]+5, paste(Rights[i]), cex=0.7, f=2, col="gray60")
lines(c(0.7+valor_label_r,0.7+valor_label_r),c(0,Rights[i]), col="gray87", lwd=2,lty=4)
valor_label_r <- valor_label_r+1.2}}
PUnos <- NULL
for(i in 1:length(Items)){
PUnos[i] <- (((Unos[i])/length(Score_FA[Datos$GRADO==g]))*100)
}
valor_label <- 1.2
barplot(PUnos, col="gray96", ann=F, axes=F, ylim=c(0,100))
axis(2,at=seq(0,100,10),labels=paste(seq(0,100,10),"%"),las=1, line=-1.5)
text(32.5, 115, "Forma 2", f=2, col="lightgoldenrod4")
text(27.5, 115, "Forma 1", f=2, col="lightgoldenrod3")
lines(c(30.1,30.1),c(0,120),col='black', lty=1,lwd=1.3)
lines(c(30.1,60),c(120,120),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(120,120),lty=1,lwd=4, col="lightgoldenrod1")
mtext(side=3, text = paste("Tomando en cuenta a los estudiantes de",g), line=0.5, cex=0.8, f=2)
mtext(side=3, text = "Porcentaje de estudiantes que acertaron cada item", line=1.5, cex=2, f=2)
mtext(side=1, text = "Item ID", line=2.5, cex=1.2, f=2)
axis(1,at=seq(.7,59.7,1.2),labels=seq(1,50,1), line=0, f=2,las=2)
for(i in 1:length(PRights)){
if(i==1){
text(0.7, PUnos[i]+6.5, paste(round(PUnos[i],2),"%"), cex=1.1, f=2, srt=90)
}else{
text(0.7+valor_label, PUnos[i]+6.5, paste(round(PUnos[i],2),"%"), cex=1.1, f=2, srt=90)
valor_label <- valor_label+1.2
}}
}
######################################################################
######################################################################
# Se segrega el análisis por GRADO
colores <- c("cadetblue2", "dodgerblue3")
col_dif <- c("cadetblue3", "dodgerblue4")
mean_A <- c(16.09836, 16.69355)
mean_B <- c(8.951613, 11.22623)
mean_T <- c(25.96667, 28.2)
w <- 0
for(g in sort(unique(Datos$GRADO))){
w <- w+1
valor_label <- NULL
hist(Score_FA[Datos$GRADO==g], breaks=seq(-.1,25,by=1), ann=F, axes=F, xlim=c(0,25), col= colores[w],
ylim=c(0,11),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.09,0.09),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.18,.18),lwd=2,lty=3, col="black"),lines(c(0,1),c(.27,.27),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.36,.36),lwd=2,lty=3, col="black"),lines(c(0,1),c(.45,.45),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.545,.545),lwd=2,lty=3, col="black"),lines(c(0,1),c(.635,.635),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.725,.725),lwd=2,lty=3, col="black"),lines(c(0,1),c(.82,.82),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.91,.91),lwd=2,lty=3, col="black")))
lines(c(0.9,0.9),c(0,11),col='black', lty=4,lwd=2)
text(9,10.3, paste("Respondieron la Forma A:"), f=2, cex=1.2)
text(9,9.8, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,10])==FALSE)), " estudiantes de",g, "año" ), f=2)
text(0.5,6, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,10])==TRUE)), " estudiante(s) no asistieron"), srt=90, f=2)
text(4,7.4, paste("Promedio: ",round(mean_A[w],2)), f=2)
text(4,6.3, paste("Máxima: ",round(max(Score_FA[Datos$GRADO==g]),2)), f=2)
text(4,5.9, paste("Mínima: ",round(min(Score_FA[Datos$GRADO==g]),2)), f=2)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = paste("Puntuación - Forma A"), line=1.5, cex=2, f=2)
mtext(side=3, text = paste("(",g,"año)"), line=0.2, cex=1.2, f=2)
axis(2,at=seq(0,11,1),labels=seq(0,11,1),las=1, line=-1.1)
axis(1,at=c(0.4:50.4),labels=c(0:50), line=-0.5, f=2)
hist(Score_FB[Datos$GRADO==g], breaks=seq(-0.1,25,by=1), ann=F, axes=F, xlim=c(0,25), col= colores[w],
ylim=c(0,11),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.09,0.09),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.18,.18),lwd=2,lty=3, col="black"),lines(c(0,1),c(.27,.27),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.36,.36),lwd=2,lty=3, col="black"),lines(c(0,1),c(.45,.45),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.545,.545),lwd=2,lty=3, col="black"),lines(c(0,1),c(.635,.635),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.725,.725),lwd=2,lty=3, col="black"),lines(c(0,1),c(.82,.82),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.91,.91),lwd=2,lty=3, col="black")))
lines(c(0.9,0.9),c(0,11),col='black', lty=4,lwd=2)
text(11,10.3, paste("Respondieron la Forma B:"), f=2, cex=1.2)
text(11,9.8, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,40])==FALSE)), " estudiantes de ",g ), f=2)
text(0.5,6, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,40])==TRUE)), " estudiante(s) no asistieron"), srt=90, f=2)
text(19,7.3, paste("Promedio: ",round(mean_B[w],2)), f=2)
text(19,6.3, paste("Máxima: ",round(max(Score_FB[Datos$GRADO==g]),2)), f=2)
text(19,5.9, paste("Mínima: ",round(min(Score_FB[Datos$GRADO==g]),2)), f=2)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = paste("Puntuación - Forma B"), line=1.5, cex=2, f=2)
mtext(side=3, text = paste("(",g,"año)"), line=0.2, cex=1.2, f=2)
axis(2,at=seq(0,11,1),labels=seq(0,11,1),las=1, line=-1.1)
axis(1,at=c(0.4:50.4),labels=c(0:50), line=-0.5, f=2)
Second_FB <- Score_FB+26
valor_label <- NULL
hist(c(Score_FA[Datos$GRADO==g],Second_FB[Datos$GRADO==g]),ann=F, breaks=seq(-0.1,50,1), axes=F, xlim=c(0,50), col="lightgoldenrod4", ylim=c(0,11),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.0909,0.0909),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.1818,.1818),lwd=2,lty=3, col="black"),lines(c(0,1),c(.2727,.2727),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.3636,.3636),lwd=2,lty=3, col="black"),lines(c(0,1),c(.4545,.4545),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.5454,.5454),lwd=2,lty=3, col="black"),lines(c(0,1),c(.6363,.6363),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.7272,.7272),lwd=2,lty=3, col="black"),lines(c(0,1),c(.8181,.8181),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.909,.909),lwd=2,lty=3, col="black")))
lines(c(0.9,0.9),c(0,16),col='black', lty=4,lwd=2)
text(45.5, 15, "Forma 2", f=2, col="lightgoldenrod4", cex=2)
text(5.5, 15, "Forma 1", f=2, col="lightgoldenrod3", cex=2)
lines(c(25.9,25.9),c(0,16),col='black', lty=1,lwd=3)
lines(c(26.9,26.9),c(0,16),col='black', lty=4,lwd=2)
text(26.3,5, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,40])==TRUE)), " estudiante(s) no asistieron"), srt=90, f=2)
lines(c(30.1,60),c(120,120),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(120,120),lty=1,lwd=4, col="lightgoldenrod1")
text(6.5,8.8, paste("Respondieron la Forma A:"), f=2)
text(6,8.3, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,15])==FALSE)), " estudiantes de ",g ), f=2)
text(6,6.8, paste("Promedio: ",round(mean_B[w],2)), f=2)
text(46,8.8, paste("Respondieron la Forma B:"), f=2)
text(46,8.3, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,40])==FALSE)), " estudiantes de ",g ), f=2)
text(0.3,5, paste(length(which(is.na(Dicot[(Datos$GRADO==g)==TRUE,15])==TRUE)), " estudiante(s) no asistieron"), srt=90, f=2)
text(46,6.8, paste("Promedio: ",round(mean_B[w],2)), f=2)
mtext(side=1, text = "Puntuaciones", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = "Puntuaciones - Formas A y B", line=1.5, cex=2, f=2)
mtext(side=3, text = paste("(",g,"año)"), line=0.2, cex=1.2, f=2)
axis(2,at=seq(0,11,1),labels=seq(0,11,1),las=1, line=-1.2)
axis(1,at=seq(0.4,51.4,1),labels=c(c(0:25),c(0:25)), line=-0.5, f=2)
Completo <- 0
Total_Completo <- NULL
Falta_FA <- is.na(Dicot[(Datos$GRADO==g)==TRUE,10])
Falta_FB <- is.na(Dicot[(Datos$GRADO==g)==TRUE,40])
FA <- Score_FA[Datos$GRADO==g]
FB <- Score_FB[Datos$GRADO==g]
for(a in 1:length(Sujetos[Datos$GRADO==g])){
if(Falta_FA[a]==TRUE){
nada <- "nada"}else{
if(Falta_FB[a]==FALSE){
Completo <- Completo + 1
Total_Completo[Completo] <- FA[a]+FB[a]
}else{
nada <- "nada"
}}}
hist(Total_Completo, breaks=seq(0,50,by=1), ann=F, axes=F, xlim=c(0,50), col= colores[w],
ylim=c(0,6),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.165,0.165),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.33,.33),lwd=2,lty=3, col="black"),lines(c(0,1),c(.498,.498),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.665,.665),lwd=2,lty=3, col="black"),lines(c(0,1),c(.83,.83),lwd=2,lty=3, col="black")))
text(40,5.8, paste(Completo, "de", length(FA),"estudiantes"), f=2,cex=1.3)
text(40,5.5, paste("respondieron todo el examen"), f=2, cex=1.3)
text(9,4.5, paste("Promedio: ",round(mean_T[w],2)), f=2,cex=1.1)
text(9,3.8, paste("Máxima: ",max(Total_Completo)), f=2, cex=1.1)
text(9,3.5, paste("Mínima: ",min(Total_Completo)), f=2, cex=1.1)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = paste("Puntuaciones Totales en",g, "año"), line=1.5, cex=2, f=2)
mtext(side=3, text = "(Contando sólo los estudiantes que hicieron ambas formas)", line=0.5, cex=, f=2)
axis(2,at=seq(0,6,1),labels=seq(0,6,1),las=1, line=-1.1)
axis(1,at=c(0.5:50.5),labels=c(1:51), line=-0.5, f=2)
hist(Total_Completo, breaks=seq(0,50,by=5), ann=F, axes=F, xlim=c(0,50), col= colores[w],
ylim=c(0,15),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.065,0.065),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.132,.132),lwd=2,lty=3, col="black"),lines(c(0,1),c(.195,.195),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.262,.262),lwd=2,lty=3, col="black"),lines(c(0,1),c(.33,.33),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.4,.4),lwd=2,lty=3, col="black"),lines(c(0,1),c(.465,.465),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.532,.532),lwd=2,lty=3, col="black"),lines(c(0,1),c(.595,.595),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.662,.662),lwd=2,lty=3, col="black"),lines(c(0,1),c(.73,.73),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.865,.865),lwd=2,lty=3, col="black"),lines(c(0,1),c(.932,.932),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.8,.8),lwd=2,lty=3, col="black")))
text(40,14.4, paste(Completo, "de", length(FA),"estudiantes"), f=2,cex=1.3)
text(40,13.4, paste("respondieron todo el examen"), f=2, cex=1.3)
text(9,10.3, paste("Promedio: ",round(mean_T[w],2)), f=2,cex=1.1)
text(9,8.4, paste("Máxima: ",max(Total_Completo)), f=2, cex=1.1)
text(9,7.7, paste("Mínima: ",min(Total_Completo)), f=2, cex=1.1)
mtext(side=1, text = "Puntuación", line=2.8, cex=1.3, f=2)
mtext(side=2, text = "Frecuencia", line=1, cex=1.3, f=2)
mtext(side=3, text = paste("Puntuación TOTAL -",g, "año"), line=1.5, cex=2, f=2)
mtext(side=3, text = "(Contando sólo los estudiantes que hicieron ambas formas)", line=0.5, cex=, f=2)
axis(2,at=seq(0,15,1),labels=seq(0,15,1),las=1, line=-1.1)
axis(1,at=seq(2.5,50,5),labels=c("0-5","5-10","11-15","16-20","21-25","26-30","31-35","36-40","41-45","46-50"), line=-0.5, f=2)
P <- NULL
for(i in 1:length(Items)){
P[i] <- mean(Dicot[(Datos$GRADO==g)==TRUE,i+7],na.rm = TRUE)
}
hist(P,breaks = seq(-0.001,1,0.05), col=col_dif[w], main="Indices de dificultad generales registrados",
xlab="", ann=F, axes=F, ylim=c(0,7),
panel.first =
c(lines(c(0,1),c(1,1),lwd=2,lty=3, col="black"),lines(c(0,1),c(0.14,0.14),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.285,.285),lwd=2,lty=3, col="black"),lines(c(0,1),c(.43,.43),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.71,.71),lwd=2,lty=3, col="black"),lines(c(0,1),c(.57,.57),lwd=2,lty=3, col="black"),
lines(c(0,1),c(.855,.855),lwd=2,lty=3, col="black")))
axis(2,at=seq(0,7,1),labels=seq(0,7,1),las=1, line=-1.5)
mtext(side=3, text = "Porcentaje de estudiantes que acertaron cada item", line=0.5, cex=1.2, f=2)
mtext(side=3, text = paste("Dificultad de los ítems para", g,"año"), line=1.5, cex=2, f=2)
mtext(side=2, text = "Frecuencia (No. de items)", line=0.5, cex=1.2, f=2)
axis(1,at=seq(0.025,1,0.05),labels=c("0 a 5%","6 a 10%","11 a 15%","16 a 20%","21 a 25%","26 a 30%","31 a 35%","36 a 40%","41 a 45%","46 a 50%","51 a 55%","56 a 60%","61 a 65%","66 a 70%","71 a 75%","76 a 80%","81 a 85%","86 a 90%","91 a 95%","96 a 100%"), line=-0.5, f=2,las=2)
print(g)
print(which(P<.3))
print(P[40])
print(P[48])
print(P[27])
print(P[31])
#Aciertos por item
Unos <- NULL
for(i in 1:length(Items)){
Unos[i] <- sum(Dicot[(Datos$GRADO==g)==TRUE,i+7], na.rm = TRUE)
}
valor_label_u <- 1.2
valor_label_r <- 1.2
barplot(Unos, col="gray96", ann=F, axes=F, ylim=c(0,120))
axis(2,at=seq(0,120,6),labels=seq(0,120,6),las=1, line=-1.5)
text(32.5, 115, "Forma 2", f=2, col="lightgoldenrod4")
text(27.5, 115, "Forma 1", f=2, col="lightgoldenrod3")
lines(c(30.1,30.1),c(0,120),col='black', lty=1,lwd=1.3)
lines(c(30.1,60),c(120,120),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(120,120),lty=1,lwd=4, col="lightgoldenrod1")
mtext(side=3, text = paste("Tomando en cuenta a los estudiantes de", g, "y comparándolos con la muestra total"), line=0.5, cex=0.8, f=2)
mtext(side=3, text = "Número de estudiantes que acertaron cada item", line=1.5, cex=2, f=2)
mtext(side=1, text = "Item ID", line=2.5, cex=1.2, f=2)
axis(1,at=seq(.7,59.7,1.2),labels=seq(1,50,1), line=0, f=2,las=2)
for(i in 1:length(Unos)){
if(i==1){
text(0.7, Unos[i]+0, paste(Unos[i]), cex=1.1, f=2)
}else{
text(0.7+valor_label_u, Unos[i]+5, paste(Unos[i]), cex=1.1, f=2)
valor_label_u <- valor_label_u+1.2
}}
for(i in 1:length(Rights)){
if(i==1){
text(0.7, Rights[i]+0, paste(Rights[i]), cex=0.7, f=2, col="gray60")
lines(c(0.7,0.7),c(0,Rights[i]), col="gray87", lwd=2,lty=4)
}else{
text(0.7+valor_label_r, Rights[i]+5, paste(Rights[i]), cex=0.7, f=2, col="gray60")
lines(c(0.7+valor_label_r,0.7+valor_label_r),c(0,Rights[i]), col="gray87", lwd=2,lty=4)
valor_label_r <- valor_label_r+1.2}}
PUnos <- NULL
for(i in 1:length(Items)){
PUnos[i] <- (((Unos[i])/length(Score_FA[Datos$GRADO==g]))*100)
}
valor_label <- 1.2
barplot(PUnos, col="gray96", ann=F, axes=F, ylim=c(0,100))
axis(2,at=seq(0,100,10),labels=paste(seq(0,100,10),"%"),las=1, line=-1.5)
text(32.5, 115, "Forma 2", f=2, col="lightgoldenrod4")
text(27.5, 115, "Forma 1", f=2, col="lightgoldenrod3")
lines(c(30.1,30.1),c(0,120),col='black', lty=1,lwd=1.3)
lines(c(30.1,60),c(120,120),lty=1,lwd=4, col="lightgoldenrod2")
lines(c(30.1,0),c(120,120),lty=1,lwd=4, col="lightgoldenrod1")
mtext(side=3, text = paste("Tomando en cuenta a los estudiantes de",g), line=0.5, cex=0.8, f=2)
mtext(side=3, text = "Porcentaje de estudiantes que acertaron cada item", line=1.5, cex=2, f=2)
mtext(side=1, text = "Item ID", line=2.5, cex=1.2, f=2)
axis(1,at=seq(.7,59.7,1.2),labels=seq(1,50,1), line=0, f=2,las=2)
for(i in 1:length(PRights)){
if(i==1){
text(0.7, PUnos[i]+6.5, paste(round(PUnos[i],2),"%"), cex=1.1, f=2, srt=90)
}else{
text(0.7+valor_label, PUnos[i]+6.5, paste(round(PUnos[i],2),"%"), cex=1.1, f=2, srt=90)
valor_label <- valor_label+1.2
}}
}
